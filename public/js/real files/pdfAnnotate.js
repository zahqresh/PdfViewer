(function(n,t){typeof exports=="object"&&typeof module=="object"?module.exports=t():typeof define=="function"&&define.amd?define("pdfAnnotate",[],t):typeof exports=="object"?exports.pdfAnnotate=t():n.pdfAnnotate=t()})(window,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})},t.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){var r,u;if((i&1&&(n=t(n)),i&8)||i&4&&typeof n=="object"&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),i&2&&typeof n!="string")for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r},t.n=function(n){var i=n&&n.__esModule?function(){return n["default"]}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s="./src/index.ts")}({"./node_modules/pako/index.js":function(n,t,i){"use strict";var u=i("./node_modules/pako/lib/utils/common.js").assign,f=i("./node_modules/pako/lib/deflate.js"),e=i("./node_modules/pako/lib/inflate.js"),o=i("./node_modules/pako/lib/zlib/constants.js"),r={};u(r,f,e,o);n.exports=r},"./node_modules/pako/lib/deflate.js":function(n,t,i){"use strict";function r(n){var t,i,h;if(!(this instanceof r))return new r(n);if(this.options=e.assign({level:w,method:k,chunkSize:16384,windowBits:15,memLevel:8,strategy:b,to:""},n||{}),t=this.options,t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0,i=f.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy),i!==u)throw new Error(s[i]);if(t.header&&f.deflateSetHeader(this.strm,t.header),t.dictionary){if(h=typeof t.dictionary=="string"?o.string2buf(t.dictionary):l.call(t.dictionary)==="[object ArrayBuffer]"?new Uint8Array(t.dictionary):t.dictionary,i=f.deflateSetDictionary(this.strm,h),i!==u)throw new Error(s[i]);this._dict_set=!0}}function c(n,t){var i=new r(t);if(i.push(n,!0),i.err)throw i.msg||s[i.err];return i.result}function d(n,t){return t=t||{},t.raw=!0,c(n,t)}function g(n,t){return t=t||{},t.gzip=!0,c(n,t)}var f=i("./node_modules/pako/lib/zlib/deflate.js"),e=i("./node_modules/pako/lib/utils/common.js"),o=i("./node_modules/pako/lib/utils/strings.js"),s=i("./node_modules/pako/lib/zlib/messages.js"),y=i("./node_modules/pako/lib/zlib/zstream.js"),l=Object.prototype.toString,p=0,h=4,u=0,a=1,v=2,w=-1,b=0,k=8;r.prototype.push=function(n,t){var i=this.strm,c=this.options.chunkSize,r,s;if(this.ended)return!1;s=t===~~t?t:t===!0?h:p;i.input=typeof n=="string"?o.string2buf(n):l.call(n)==="[object ArrayBuffer]"?new Uint8Array(n):n;i.next_in=0;i.avail_in=i.input.length;do{if(i.avail_out===0&&(i.output=new e.Buf8(c),i.next_out=0,i.avail_out=c),r=f.deflate(i,s),r!==a&&r!==u){this.onEnd(r);return this.ended=!0,!1}if(i.avail_out===0||i.avail_in===0&&(s===h||s===v))if(this.options.to==="string")this.onData(o.buf2binstring(e.shrinkBuf(i.output,i.next_out)));else this.onData(e.shrinkBuf(i.output,i.next_out))}while((i.avail_in>0||i.avail_out===0)&&r!==a);if(s===h){r=f.deflateEnd(this.strm);this.onEnd(r);return this.ended=!0,r===u}if(s===v){this.onEnd(u);return i.avail_out=0,!0}return!0};r.prototype.onData=function(n){this.chunks.push(n)};r.prototype.onEnd=function(n){n===u&&(this.result=this.options.to==="string"?this.chunks.join(""):e.flattenChunks(this.chunks));this.chunks=[];this.err=n;this.msg=this.strm.msg};t.Deflate=r;t.deflate=c;t.deflateRaw=d;t.gzip=g},"./node_modules/pako/lib/inflate.js":function(n,t,i){"use strict";function u(n){var t,i;if(!(this instanceof u))return new u(n);if(this.options=e.assign({chunkSize:16384,windowBits:0,to:""},n||{}),t=this.options,t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(n&&n.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)==0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0,i=f.inflateInit2(this.strm,t.windowBits),i!==r.Z_OK)throw new Error(s[i]);if(this.header=new a,f.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=o.string2buf(t.dictionary):c.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=f.inflateSetDictionary(this.strm,t.dictionary),i!==r.Z_OK)))throw new Error(s[i]);}function h(n,t){var i=new u(t);if(i.push(n,!0),i.err)throw i.msg||s[i.err];return i.result}function v(n,t){return t=t||{},t.raw=!0,h(n,t)}var f=i("./node_modules/pako/lib/zlib/inflate.js"),e=i("./node_modules/pako/lib/utils/common.js"),o=i("./node_modules/pako/lib/utils/strings.js"),r=i("./node_modules/pako/lib/zlib/constants.js"),s=i("./node_modules/pako/lib/zlib/messages.js"),l=i("./node_modules/pako/lib/zlib/zstream.js"),a=i("./node_modules/pako/lib/zlib/gzheader.js"),c=Object.prototype.toString;u.prototype.push=function(n,t){var i=this.strm,a=this.options.chunkSize,y=this.options.dictionary,u,s,l,h,p,v=!1;if(this.ended)return!1;s=t===~~t?t:t===!0?r.Z_FINISH:r.Z_NO_FLUSH;i.input=typeof n=="string"?o.binstring2buf(n):c.call(n)==="[object ArrayBuffer]"?new Uint8Array(n):n;i.next_in=0;i.avail_in=i.input.length;do{if(i.avail_out===0&&(i.output=new e.Buf8(a),i.next_out=0,i.avail_out=a),u=f.inflate(i,r.Z_NO_FLUSH),u===r.Z_NEED_DICT&&y&&(u=f.inflateSetDictionary(this.strm,y)),u===r.Z_BUF_ERROR&&v===!0&&(u=r.Z_OK,v=!1),u!==r.Z_STREAM_END&&u!==r.Z_OK){this.onEnd(u);return this.ended=!0,!1}if(i.next_out&&(i.avail_out===0||u===r.Z_STREAM_END||i.avail_in===0&&(s===r.Z_FINISH||s===r.Z_SYNC_FLUSH)))if(this.options.to==="string"){l=o.utf8border(i.output,i.next_out);h=i.next_out-l;p=o.buf2string(i.output,l);i.next_out=h;i.avail_out=a-h;h&&e.arraySet(i.output,i.output,l,h,0);this.onData(p)}else this.onData(e.shrinkBuf(i.output,i.next_out));i.avail_in===0&&i.avail_out===0&&(v=!0)}while((i.avail_in>0||i.avail_out===0)&&u!==r.Z_STREAM_END);if(u===r.Z_STREAM_END&&(s=r.Z_FINISH),s===r.Z_FINISH){u=f.inflateEnd(this.strm);this.onEnd(u);return this.ended=!0,u===r.Z_OK}if(s===r.Z_SYNC_FLUSH){this.onEnd(r.Z_OK);return i.avail_out=0,!0}return!0};u.prototype.onData=function(n){this.chunks.push(n)};u.prototype.onEnd=function(n){n===r.Z_OK&&(this.result=this.options.to==="string"?this.chunks.join(""):e.flattenChunks(this.chunks));this.chunks=[];this.err=n;this.msg=this.strm.msg};t.Inflate=u;t.inflate=h;t.inflateRaw=v;t.ungzip=h},"./node_modules/pako/lib/utils/common.js":function(n,t){"use strict";function f(n,t){return Object.prototype.hasOwnProperty.call(n,t)}var u=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined",i,r;t.assign=function(n){for(var r=Array.prototype.slice.call(arguments,1),t,i;r.length;)if(t=r.shift(),t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(i in t)f(t,i)&&(n[i]=t[i])}return n};t.shrinkBuf=function(n,t){return n.length===t?n:n.subarray?n.subarray(0,t):(n.length=t,n)};i={arraySet:function(n,t,i,r,u){if(t.subarray&&n.subarray){n.set(t.subarray(i,i+r),u);return}for(var f=0;f<r;f++)n[u+f]=t[i+f]},flattenChunks:function(n){var t,i,r,u,f,e;for(r=0,t=0,i=n.length;t<i;t++)r+=n[t].length;for(e=new Uint8Array(r),u=0,t=0,i=n.length;t<i;t++)f=n[t],e.set(f,u),u+=f.length;return e}};r={arraySet:function(n,t,i,r,u){for(var f=0;f<r;f++)n[u+f]=t[i+f]},flattenChunks:function(n){return[].concat.apply([],n)}};t.setTyped=function(n){n?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,r))};t.setTyped(u)},"./node_modules/pako/lib/utils/strings.js":function(n,t,i){"use strict";function s(n,t){var r,i;if(t<65534&&(n.subarray&&o||!n.subarray&&e))return String.fromCharCode.apply(null,f.shrinkBuf(n,t));for(r="",i=0;i<t;i++)r+=String.fromCharCode(n[i]);return r}var f=i("./node_modules/pako/lib/utils/common.js"),e=!0,o=!0,u,r;try{String.fromCharCode.apply(null,[0])}catch(h){e=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(h){o=!1}for(u=new f.Buf8(256),r=0;r<256;r++)u[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;u[254]=u[254]=1;t.string2buf=function(n){for(var r,t,e,u,o=n.length,s=0,i=0;i<o;i++)t=n.charCodeAt(i),(t&64512)==55296&&i+1<o&&(e=n.charCodeAt(i+1),(e&64512)==56320&&(t=65536+(t-55296<<10)+(e-56320),i++)),s+=t<128?1:t<2048?2:t<65536?3:4;for(r=new f.Buf8(s),u=0,i=0;u<s;i++)t=n.charCodeAt(i),(t&64512)==55296&&i+1<o&&(e=n.charCodeAt(i+1),(e&64512)==56320&&(t=65536+(t-55296<<10)+(e-56320),i++)),t<128?r[u++]=t:t<2048?(r[u++]=192|t>>>6,r[u++]=128|t&63):t<65536?(r[u++]=224|t>>>12,r[u++]=128|t>>>6&63,r[u++]=128|t&63):(r[u++]=240|t>>>18,r[u++]=128|t>>>12&63,r[u++]=128|t>>>6&63,r[u++]=128|t&63);return r};t.buf2binstring=function(n){return s(n,n.length)};t.binstring2buf=function(n){for(var i=new f.Buf8(n.length),t=0,r=i.length;t<r;t++)i[t]=n.charCodeAt(t);return i};t.buf2string=function(n,t){for(var i,f,h=t||n.length,e=new Array(h*2),r=0,o=0;o<h;){if(i=n[o++],i<128){e[r++]=i;continue}if(f=u[i],f>4){e[r++]=65533;o+=f-1;continue}for(i&=f===2?31:f===3?15:7;f>1&&o<h;)i=i<<6|n[o++]&63,f--;if(f>1){e[r++]=65533;continue}i<65536?e[r++]=i:(i-=65536,e[r++]=55296|i>>10&1023,e[r++]=56320|i&1023)}return s(e,r)};t.utf8border=function(n,t){var i;for(t=t||n.length,t>n.length&&(t=n.length),i=t-1;i>=0&&(n[i]&192)==128;)i--;return i<0?t:i===0?t:i+u[n[i]]>t?i:t}},"./node_modules/pako/lib/zlib/adler32.js":function(n){"use strict";function t(n,t,i,r){for(var u=n&65535|0,f=n>>>16&65535|0,e=0;i!==0;){e=i>2e3?2e3:i;i-=e;do u=u+t[r++]|0,f=f+u|0;while(--e);u%=65521;f%=65521}return u|f<<16|0}n.exports=t},"./node_modules/pako/lib/zlib/constants.js":function(n){"use strict";n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"./node_modules/pako/lib/zlib/crc32.js":function(n){"use strict";function t(){for(var i,n,r=[],t=0;t<256;t++){for(n=t,i=0;i<8;i++)n=n&1?3988292384^n>>>1:n>>>1;r[t]=n}return r}function r(n,t,r,u){var e=i,o=u+r,f;for(n^=-1,f=u;f<o;f++)n=n>>>8^e[(n^t[f])&255];return n^-1}var i=t();n.exports=r},"./node_modules/pako/lib/zlib/deflate.js":function(n,t,i){"use strict";function w(n,t){return n.msg=fi[t],t}function ni(n){return(n<<1)-(n>4?9:0)}function b(n){for(var t=n.length;--t>=0;)n[t]=0}function k(n){var i=n.state,t=i.pending;(t>n.avail_out&&(t=n.avail_out),t!==0)&&(o.arraySet(n.output,i.pending_buf,i.pending_out,t,n.next_out),n.next_out+=t,i.pending_out+=t,n.total_out+=t,n.avail_out-=t,i.pending-=t,i.pending===0&&(i.pending_out=0))}function e(n,t){s._tr_flush_block(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,t);n.block_start=n.strstart;k(n.strm)}function u(n,t){n.pending_buf[n.pending++]=t}function ot(n,t){n.pending_buf[n.pending++]=t>>>8&255;n.pending_buf[n.pending++]=t&255}function rr(n,t,i,r){var u=n.avail_in;return(u>r&&(u=r),u===0)?0:(n.avail_in-=u,o.arraySet(t,n.input,n.next_in,u,i),n.state.wrap===1?n.adler=kt(n.adler,t,u,i):n.state.wrap===2&&(n.adler=v(n.adler,t,u,i)),n.next_in+=u,n.total_in+=u,u)}function ti(n,t){var h=n.max_chain_length,r=n.strstart,u,e,f=n.prev_length,o=n.nice_match,v=n.strstart>n.w_size-c?n.strstart-(n.w_size-c):0,i=n.window,y=n.w_mask,w=n.prev,s=n.strstart+p,l=i[r+f-1],a=i[r+f];n.prev_length>=n.good_match&&(h>>=2);o>n.lookahead&&(o=n.lookahead);do if(u=t,i[u+f]===a&&i[u+f-1]===l&&i[u]===i[r]&&i[++u]===i[r+1]){r+=2;u++;do;while(i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&r<s);if(e=p-(s-r),r=s-p,e>f){if(n.match_start=t,f=e,e>=o)break;l=i[r+f-1];a=i[r+f]}}while((t=w[t&y])>v&&--h!=0);return f<=n.lookahead?f:n.lookahead}function tt(n){var t=n.w_size,f,i,e,s,u;do{if(s=n.window_size-n.lookahead-n.strstart,n.strstart>=t+(t-c)){o.arraySet(n.window,n.window,t,t,0);n.match_start-=t;n.strstart-=t;n.block_start-=t;i=n.hash_size;f=i;do e=n.head[--f],n.head[f]=e>=t?e-t:0;while(--i);i=t;f=i;do e=n.prev[--f],n.prev[f]=e>=t?e-t:0;while(--i);s+=t}if(n.strm.avail_in===0)break;if(i=rr(n.strm,n.window,n.strstart+n.lookahead,s),n.lookahead+=i,n.lookahead+n.insert>=r)for(u=n.strstart-n.insert,n.ins_h=n.window[u],n.ins_h=(n.ins_h<<n.hash_shift^n.window[u+1])&n.hash_mask;n.insert;)if(n.ins_h=(n.ins_h<<n.hash_shift^n.window[u+r-1])&n.hash_mask,n.prev[u&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=u,u++,n.insert--,n.lookahead+n.insert<r)break}while(n.lookahead<c&&n.strm.avail_in!==0)}function ur(n,t){var r=65535,i;for(r>n.pending_buf_size-5&&(r=n.pending_buf_size-5);;){if(n.lookahead<=1){if(tt(n),n.lookahead===0&&t===d)return f;if(n.lookahead===0)break}if((n.strstart+=n.lookahead,n.lookahead=0,i=n.block_start+r,(n.strstart===0||n.strstart>=i)&&(n.lookahead=n.strstart-i,n.strstart=i,e(n,!1),n.strm.avail_out===0))||n.strstart-n.block_start>=n.w_size-c&&(e(n,!1),n.strm.avail_out===0))return f}return(n.insert=0,t===y)?(e(n,!0),n.strm.avail_out===0)?nt:it:(n.strstart>n.block_start&&(e(n,!1),n.strm.avail_out===0),f)}function bt(n,t){for(var i,u;;){if(n.lookahead<c){if(tt(n),n.lookahead<c&&t===d)return f;if(n.lookahead===0)break}if(i=0,n.lookahead>=r&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+r-1])&n.hash_mask,i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),i!==0&&n.strstart-i<=n.w_size-c&&(n.match_length=ti(n,i)),n.match_length>=r)if(u=s._tr_tally(n,n.strstart-n.match_start,n.match_length-r),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=r){n.match_length--;do n.strstart++,n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+r-1])&n.hash_mask,i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!=0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+1])&n.hash_mask;else u=s._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(u&&(e(n,!1),n.strm.avail_out===0))return f}return(n.insert=n.strstart<r-1?n.strstart:r-1,t===y)?(e(n,!0),n.strm.avail_out===0)?nt:it:n.last_lit&&(e(n,!1),n.strm.avail_out===0)?f:et}function rt(n,t){for(var i,u,o;;){if(n.lookahead<c){if(tt(n),n.lookahead<c&&t===d)return f;if(n.lookahead===0)break}if(i=0,n.lookahead>=r&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+r-1])&n.hash_mask,i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=r-1,i!==0&&n.prev_length<n.max_lazy_match&&n.strstart-i<=n.w_size-c&&(n.match_length=ti(n,i),n.match_length<=5&&(n.strategy===ci||n.match_length===r&&n.strstart-n.match_start>4096)&&(n.match_length=r-1)),n.prev_length>=r&&n.match_length<=n.prev_length){o=n.strstart+n.lookahead-r;u=s._tr_tally(n,n.strstart-1-n.prev_match,n.prev_length-r);n.lookahead-=n.prev_length-1;n.prev_length-=2;do++n.strstart<=o&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+r-1])&n.hash_mask,i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!=0);if(n.match_available=0,n.match_length=r-1,n.strstart++,u&&(e(n,!1),n.strm.avail_out===0))return f}else if(n.match_available){if(u=s._tr_tally(n,0,n.window[n.strstart-1]),u&&e(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return f}else n.match_available=1,n.strstart++,n.lookahead--}return(n.match_available&&(u=s._tr_tally(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<r-1?n.strstart:r-1,t===y)?(e(n,!0),n.strm.avail_out===0)?nt:it:n.last_lit&&(e(n,!1),n.strm.avail_out===0)?f:et}function fr(n,t){for(var h,u,i,c,o=n.window;;){if(n.lookahead<=p){if(tt(n),n.lookahead<=p&&t===d)return f;if(n.lookahead===0)break}if(n.match_length=0,n.lookahead>=r&&n.strstart>0&&(i=n.strstart-1,u=o[i],u===o[++i]&&u===o[++i]&&u===o[++i])){c=n.strstart+p;do;while(u===o[++i]&&u===o[++i]&&u===o[++i]&&u===o[++i]&&u===o[++i]&&u===o[++i]&&u===o[++i]&&u===o[++i]&&i<c);n.match_length=p-(c-i);n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=r?(h=s._tr_tally(n,1,n.match_length-r),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(h=s._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),h&&(e(n,!1),n.strm.avail_out===0))return f}return(n.insert=0,t===y)?(e(n,!0),n.strm.avail_out===0)?nt:it:n.last_lit&&(e(n,!1),n.strm.avail_out===0)?f:et}function er(n,t){for(var i;;){if(n.lookahead===0&&(tt(n),n.lookahead===0)){if(t===d)return f;break}if(n.match_length=0,i=s._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,i&&(e(n,!1),n.strm.avail_out===0))return f}return(n.insert=0,t===y)?(e(n,!0),n.strm.avail_out===0)?nt:it:n.last_lit&&(e(n,!1),n.strm.avail_out===0)?f:et}function a(n,t,i,r,u){this.good_length=n;this.max_lazy=t;this.nice_length=i;this.max_chain=r;this.func=u}function or(n){n.window_size=2*n.w_size;b(n.head);n.max_lazy_match=ut[n.level].max_lazy;n.good_match=ut[n.level].good_length;n.nice_match=ut[n.level].nice_length;n.max_chain_length=ut[n.level].max_chain;n.strstart=0;n.block_start=0;n.lookahead=0;n.insert=0;n.match_length=n.prev_length=r-1;n.match_available=0;n.ins_h=0}function sr(){this.strm=null;this.status=0;this.pending_buf=null;this.pending_buf_size=0;this.pending_out=0;this.pending=0;this.wrap=0;this.gzhead=null;this.gzindex=0;this.method=ht;this.last_flush=-1;this.w_size=0;this.w_bits=0;this.w_mask=0;this.window=null;this.window_size=0;this.prev=null;this.head=null;this.ins_h=0;this.hash_size=0;this.hash_bits=0;this.hash_mask=0;this.hash_shift=0;this.block_start=0;this.match_length=0;this.prev_match=0;this.match_available=0;this.strstart=0;this.match_start=0;this.lookahead=0;this.prev_length=0;this.max_chain_length=0;this.max_lazy_match=0;this.level=0;this.strategy=0;this.good_match=0;this.nice_match=0;this.dyn_ltree=new o.Buf16(gi*2);this.dyn_dtree=new o.Buf16((2*ki+1)*2);this.bl_tree=new o.Buf16((2*di+1)*2);b(this.dyn_ltree);b(this.dyn_dtree);b(this.bl_tree);this.l_desc=null;this.d_desc=null;this.bl_desc=null;this.bl_count=new o.Buf16(nr+1);this.heap=new o.Buf16(2*pt+1);b(this.heap);this.heap_len=0;this.heap_max=0;this.depth=new o.Buf16(2*pt+1);b(this.depth);this.l_buf=0;this.lit_bufsize=0;this.last_lit=0;this.d_buf=0;this.opt_len=0;this.static_len=0;this.matches=0;this.insert=0;this.bi_buf=0;this.bi_valid=0}function ii(n){var t;return!n||!n.state?w(n,h):(n.total_in=n.total_out=0,n.data_type=yi,t=n.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?ct:g,n.adler=t.wrap===2?0:1,t.last_flush=d,s._tr_init(t),l)}function ri(n){var t=ii(n);return t===l&&or(n.state),t}function hr(n,t){return!n||!n.state?h:n.state.wrap!==2?h:(n.state.gzhead=t,l)}function ui(n,t,i,u,f,e){var c,s;return n?(c=1,t===hi&&(t=6),u<0?(c=0,u=-u):u>15&&(c=2,u-=16),f<1||f>pi||i!==ht||u<8||u>15||t<0||t>9||e<0||e>ai)?w(n,h):(u===8&&(u=9),s=new sr,n.state=s,s.strm=n,s.wrap=c,s.gzhead=null,s.w_bits=u,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=f+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+r-1)/r),s.window=new o.Buf8(s.w_size*2),s.head=new o.Buf16(s.hash_size),s.prev=new o.Buf16(s.w_size),s.lit_bufsize=1<<f+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new o.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=e,s.method=i,ri(n)):h}function cr(n,t){return ui(n,t,ht,wi,bi,vi)}function lr(n,t){var p,i,r,e,o,a,c;if(!n||!n.state||t>dt||t<0)return n?w(n,h):h;if(i=n.state,!n.output||!n.input&&n.avail_in!==0||i.status===ft&&t!==y)return w(n,n.avail_out===0?yt:h);if(i.strm=n,p=i.last_flush,i.last_flush=t,i.status===ct&&(i.wrap===2?(n.adler=0,u(i,31),u(i,139),u(i,8),i.gzhead?(u(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),u(i,i.gzhead.time&255),u(i,i.gzhead.time>>8&255),u(i,i.gzhead.time>>16&255),u(i,i.gzhead.time>>24&255),u(i,i.level===9?2:i.strategy>=st||i.level<2?4:0),u(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(u(i,i.gzhead.extra.length&255),u(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(n.adler=v(n.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=wt):(u(i,0),u(i,0),u(i,0),u(i,0),u(i,0),u(i,i.level===9?2:i.strategy>=st||i.level<2?4:0),u(i,ir),i.status=g)):(o=ht+(i.w_bits-8<<4)<<8,a=-1,a=i.strategy>=st||i.level<2?0:i.level<6?1:i.level===6?2:3,o|=a<<6,i.strstart!==0&&(o|=tr),o+=31-o%31,i.status=g,ot(i,o),i.strstart!==0&&(ot(i,n.adler>>>16),ot(i,n.adler&65535)),n.adler=1)),i.status===wt)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535);){if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(n.adler=v(n.adler,i.pending_buf,i.pending-r,r)),k(n),r=i.pending,i.pending===i.pending_buf_size))break;u(i,i.gzhead.extra[i.gzindex]&255);i.gzindex++}i.gzhead.hcrc&&i.pending>r&&(n.adler=v(n.adler,i.pending_buf,i.pending-r,r));i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=lt)}else i.status=lt;if(i.status===lt)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(n.adler=v(n.adler,i.pending_buf,i.pending-r,r)),k(n),r=i.pending,i.pending===i.pending_buf_size)){e=1;break}e=i.gzindex<i.gzhead.name.length?i.gzhead.name.charCodeAt(i.gzindex++)&255:0;u(i,e)}while(e!==0);i.gzhead.hcrc&&i.pending>r&&(n.adler=v(n.adler,i.pending_buf,i.pending-r,r));e===0&&(i.gzindex=0,i.status=at)}else i.status=at;if(i.status===at)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(n.adler=v(n.adler,i.pending_buf,i.pending-r,r)),k(n),r=i.pending,i.pending===i.pending_buf_size)){e=1;break}e=i.gzindex<i.gzhead.comment.length?i.gzhead.comment.charCodeAt(i.gzindex++)&255:0;u(i,e)}while(e!==0);i.gzhead.hcrc&&i.pending>r&&(n.adler=v(n.adler,i.pending_buf,i.pending-r,r));e===0&&(i.status=vt)}else i.status=vt;if(i.status===vt&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&k(n),i.pending+2<=i.pending_buf_size&&(u(i,n.adler&255),u(i,n.adler>>8&255),n.adler=0,i.status=g)):i.status=g),i.pending!==0){if(k(n),n.avail_out===0)return i.last_flush=-1,l}else if(n.avail_in===0&&ni(t)<=ni(p)&&t!==y)return w(n,yt);if(i.status===ft&&n.avail_in!==0)return w(n,yt);if(n.avail_in!==0||i.lookahead!==0||t!==d&&i.status!==ft){if(c=i.strategy===st?er(i,t):i.strategy===li?fr(i,t):ut[i.level].func(i,t),(c===nt||c===it)&&(i.status=ft),c===f||c===nt)return n.avail_out===0&&(i.last_flush=-1),l;if(c===et&&(t===ei?s._tr_align(i):t!==dt&&(s._tr_stored_block(i,0,0,!1),t===oi&&(b(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),k(n),n.avail_out===0))return i.last_flush=-1,l}return t!==y?l:i.wrap<=0?gt:(i.wrap===2?(u(i,n.adler&255),u(i,n.adler>>8&255),u(i,n.adler>>16&255),u(i,n.adler>>24&255),u(i,n.total_in&255),u(i,n.total_in>>8&255),u(i,n.total_in>>16&255),u(i,n.total_in>>24&255)):(ot(i,n.adler>>>16),ot(i,n.adler&65535)),k(n),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?l:gt)}function ar(n){var t;return!n||!n.state?h:(t=n.state.status,t!==ct&&t!==wt&&t!==lt&&t!==at&&t!==vt&&t!==g&&t!==ft)?w(n,h):(n.state=null,t===g?w(n,si):l)}function vr(n,t){var e=t.length,i,u,c,f,a,v,y,s;if(!n||!n.state||(i=n.state,f=i.wrap,f===2||f===1&&i.status!==ct||i.lookahead))return h;for(f===1&&(n.adler=kt(n.adler,t,e,0)),i.wrap=0,e>=i.w_size&&(f===0&&(b(i.head),i.strstart=0,i.block_start=0,i.insert=0),s=new o.Buf8(i.w_size),o.arraySet(s,t,e-i.w_size,i.w_size,0),t=s,e=i.w_size),a=n.avail_in,v=n.next_in,y=n.input,n.avail_in=e,n.next_in=0,n.input=t,tt(i);i.lookahead>=r;){u=i.strstart;c=i.lookahead-(r-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[u+r-1])&i.hash_mask,i.prev[u&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=u,u++;while(--c);i.strstart=u;i.lookahead=r-1;tt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=r-1,i.match_available=0,n.next_in=v,n.input=y,n.avail_in=a,i.wrap=f,l}var o=i("./node_modules/pako/lib/utils/common.js"),s=i("./node_modules/pako/lib/zlib/trees.js"),kt=i("./node_modules/pako/lib/zlib/adler32.js"),v=i("./node_modules/pako/lib/zlib/crc32.js"),fi=i("./node_modules/pako/lib/zlib/messages.js"),d=0,ei=1,oi=3,y=4,dt=5,l=0,gt=1,h=-2,si=-3,yt=-5,hi=-1,ci=1,st=2,li=3,ai=4,vi=0,yi=2,ht=8,pi=9,wi=15,bi=8,pt=286,ki=30,di=19,gi=2*pt+1,nr=15,r=3,p=258,c=p+r+1,tr=32,ct=42,wt=69,lt=73,at=91,vt=103,g=113,ft=666,f=1,et=2,nt=3,it=4,ir=3,ut;ut=[new a(0,0,0,0,ur),new a(4,4,8,4,bt),new a(4,5,16,8,bt),new a(4,6,32,32,bt),new a(4,4,16,16,rt),new a(8,16,32,32,rt),new a(8,16,128,128,rt),new a(8,32,128,256,rt),new a(32,128,258,1024,rt),new a(32,258,258,4096,rt)];t.deflateInit=cr;t.deflateInit2=ui;t.deflateReset=ri;t.deflateResetKeep=ii;t.deflateSetHeader=hr;t.deflate=lr;t.deflateEnd=ar;t.deflateSetDictionary=vr;t.deflateInfo="pako deflate (from Nodeca project)"},"./node_modules/pako/lib/zlib/gzheader.js":function(n){"use strict";function t(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=!1}n.exports=t},"./node_modules/pako/lib/zlib/inffast.js":function(n){"use strict";var t=30,i=12;n.exports=function(n,r){var c,a,d,f,rt,g,ut,nt,ft,w,k,l,e,tt,it,et,ot,v,u,h,y,s,p,b,o;c=n.state;a=n.next_in;b=n.input;d=a+(n.avail_in-5);f=n.next_out;o=n.output;rt=f-(r-n.avail_out);g=f+(n.avail_out-257);ut=c.dmax;nt=c.wsize;ft=c.whave;w=c.wnext;k=c.window;l=c.hold;e=c.bits;tt=c.lencode;it=c.distcode;et=(1<<c.lenbits)-1;ot=(1<<c.distbits)-1;n:do{e<15&&(l+=b[a++]<<e,e+=8,l+=b[a++]<<e,e+=8);v=tt[l&et];t:for(;;){if(u=v>>>24,l>>>=u,e-=u,u=v>>>16&255,u===0)o[f++]=v&65535;else if(u&16){h=v&65535;u&=15;u&&(e<u&&(l+=b[a++]<<e,e+=8),h+=l&(1<<u)-1,l>>>=u,e-=u);e<15&&(l+=b[a++]<<e,e+=8,l+=b[a++]<<e,e+=8);v=it[l&ot];i:for(;;){if(u=v>>>24,l>>>=u,e-=u,u=v>>>16&255,u&16){if(y=v&65535,u&=15,e<u&&(l+=b[a++]<<e,e+=8,e<u&&(l+=b[a++]<<e,e+=8)),y+=l&(1<<u)-1,y>ut){n.msg="invalid distance too far back";c.mode=t;break n}if(l>>>=u,e-=u,u=f-rt,y>u){if(u=y-u,u>ft&&c.sane){n.msg="invalid distance too far back";c.mode=t;break n}if(s=0,p=k,w===0){if(s+=nt-u,u<h){h-=u;do o[f++]=k[s++];while(--u);s=f-y;p=o}}else if(w<u){if(s+=nt+w-u,u-=w,u<h){h-=u;do o[f++]=k[s++];while(--u);if(s=0,w<h){u=w;h-=u;do o[f++]=k[s++];while(--u);s=f-y;p=o}}}else if(s+=w-u,u<h){h-=u;do o[f++]=k[s++];while(--u);s=f-y;p=o}while(h>2)o[f++]=p[s++],o[f++]=p[s++],o[f++]=p[s++],h-=3;h&&(o[f++]=p[s++],h>1&&(o[f++]=p[s++]))}else{s=f-y;do o[f++]=o[s++],o[f++]=o[s++],o[f++]=o[s++],h-=3;while(h>2);h&&(o[f++]=o[s++],h>1&&(o[f++]=o[s++]))}}else if((u&64)==0){v=it[(v&65535)+(l&(1<<u)-1)];continue i}else{n.msg="invalid distance code";c.mode=t;break n}break}}else if((u&64)==0){v=tt[(v&65535)+(l&(1<<u)-1)];continue t}else if(u&32){c.mode=i;break n}else{n.msg="invalid literal/length code";c.mode=t;break n}break}}while(a<d&&f<g);h=e>>3;a-=h;e-=h<<3;l&=(1<<e)-1;n.next_in=a;n.next_out=f;n.avail_in=a<d?5+(d-a):5-(a-d);n.avail_out=f<g?257+(g-f):257-(f-g);c.hold=l;c.bits=e;return}},"./node_modules/pako/lib/zlib/inflate.js":function(n,t,i){"use strict";function oi(n){return(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24)}function rr(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new u.Buf16(320);this.work=new u.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function si(n){var t;return!n||!n.state?f:(t=n.state,n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=t.wrap&1),t.mode=et,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new u.Buf32(nr),t.distcode=t.distdyn=new u.Buf32(tr),t.sane=1,t.back=-1,s)}function hi(n){var t;return!n||!n.state?f:(t=n.state,t.wsize=0,t.whave=0,t.wnext=0,si(n))}function ci(n,t){var r,i;return!n||!n.state?f:(i=n.state,t<0?(r=0,t=-t):(r=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15))?f:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,hi(n))}function li(n,t){var i,r;return n?(r=new rr,n.state=r,r.window=null,i=ci(n,t),i!==s&&(n.state=null),i):f}function ur(n){return li(n,ir)}function fr(n){if(ai){var t;for(g=new u.Buf32(512),nt=new u.Buf32(32),t=0;t<144;)n.lens[t++]=8;while(t<256)n.lens[t++]=9;while(t<280)n.lens[t++]=7;while(t<288)n.lens[t++]=8;for(h(tt,n.lens,0,288,g,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;h(it,n.lens,0,32,nt,0,n.work,{bits:5});ai=!1}n.lencode=g;n.lenbits=9;n.distcode=nt;n.distbits=5}function vi(n,t,i,r){var e,f=n.state;return f.window===null&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new u.Buf8(f.wsize)),r>=f.wsize?(u.arraySet(f.window,t,i-f.wsize,f.wsize,0),f.wnext=0,f.whave=f.wsize):(e=f.wsize-f.wnext,e>r&&(e=r),u.arraySet(f.window,t,i-r,e,f.wnext),r-=e,r?(u.arraySet(f.window,t,i-r,r,0),f.wnext=r,f.whave=f.wsize):(f.wnext+=e,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=e))),0}function er(n,t){var i,li,lr,ci,hr,si,rr,nt,g,yr,nr,hi,pr,kr,tr=0,ai,er,sr,or,wr,br,ir,cr,ur=new u.Buf8(4),vr,ar,dr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!n||!n.state||!n.output||!n.input&&n.avail_in!==0)return f;i=n.state;i.mode===o&&(i.mode=w);hr=n.next_out;lr=n.output;rr=n.avail_out;ci=n.next_in;li=n.input;si=n.avail_in;nt=i.hold;g=i.bits;yr=si;nr=rr;cr=s;n:for(;;)switch(i.mode){case et:if(i.wrap===0){i.mode=w;break}while(g<16){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}if(i.wrap&2&&nt===35615){i.check=0;ur[0]=nt&255;ur[1]=nt>>>8&255;i.check=e(i.check,ur,2,0);nt=0;g=0;i.mode=ot;break}if(i.flags=0,i.head&&(i.head.done=!1),!(i.wrap&1)||(((nt&255)<<8)+(nt>>8))%31){n.msg="incorrect header check";i.mode=r;break}if((nt&15)!==ft){n.msg="unknown compression method";i.mode=r;break}if(nt>>>=4,g-=4,ir=(nt&15)+8,i.wbits===0)i.wbits=ir;else if(ir>i.wbits){n.msg="invalid window size";i.mode=r;break}i.dmax=1<<ir;n.adler=i.check=1;i.mode=nt&512?pt:o;nt=0;g=0;break;case ot:while(g<16){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}if(i.flags=nt,(i.flags&255)!==ft){n.msg="unknown compression method";i.mode=r;break}if(i.flags&57344){n.msg="unknown header flags set";i.mode=r;break}i.head&&(i.head.text=nt>>8&1);i.flags&512&&(ur[0]=nt&255,ur[1]=nt>>>8&255,i.check=e(i.check,ur,2,0));nt=0;g=0;i.mode=st;case st:while(g<32){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}i.head&&(i.head.time=nt);i.flags&512&&(ur[0]=nt&255,ur[1]=nt>>>8&255,ur[2]=nt>>>16&255,ur[3]=nt>>>24&255,i.check=e(i.check,ur,4,0));nt=0;g=0;i.mode=ht;case ht:while(g<16){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}i.head&&(i.head.xflags=nt&255,i.head.os=nt>>8);i.flags&512&&(ur[0]=nt&255,ur[1]=nt>>>8&255,i.check=e(i.check,ur,2,0));nt=0;g=0;i.mode=ct;case ct:if(i.flags&1024){while(g<16){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}i.length=nt;i.head&&(i.head.extra_len=nt);i.flags&512&&(ur[0]=nt&255,ur[1]=nt>>>8&255,i.check=e(i.check,ur,2,0));nt=0;g=0}else i.head&&(i.head.extra=null);i.mode=lt;case lt:if(i.flags&1024&&(hi=i.length,hi>si&&(hi=si),hi&&(i.head&&(ir=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),u.arraySet(i.head.extra,li,ci,hi,ir)),i.flags&512&&(i.check=e(i.check,li,hi,ci)),si-=hi,ci+=hi,i.length-=hi),i.length))break n;i.length=0;i.mode=at;case at:if(i.flags&2048){if(si===0)break n;hi=0;do ir=li[ci+hi++],i.head&&ir&&i.length<65536&&(i.head.name+=String.fromCharCode(ir));while(ir&&hi<si);if(i.flags&512&&(i.check=e(i.check,li,hi,ci)),si-=hi,ci+=hi,ir)break n}else i.head&&(i.head.name=null);i.length=0;i.mode=vt;case vt:if(i.flags&4096){if(si===0)break n;hi=0;do ir=li[ci+hi++],i.head&&ir&&i.length<65536&&(i.head.comment+=String.fromCharCode(ir));while(ir&&hi<si);if(i.flags&512&&(i.check=e(i.check,li,hi,ci)),si-=hi,ci+=hi,ir)break n}else i.head&&(i.head.comment=null);i.mode=yt;case yt:if(i.flags&512){while(g<16){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}if(nt!==(i.check&65535)){n.msg="header crc mismatch";i.mode=r;break}nt=0;g=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0);n.adler=i.check=0;i.mode=o;break;case pt:while(g<32){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}n.adler=i.check=oi(nt);nt=0;g=0;i.mode=l;case l:if(i.havedict===0)return n.next_out=hr,n.avail_out=rr,n.next_in=ci,n.avail_in=si,i.hold=nt,i.bits=g,ki;n.adler=i.check=1;i.mode=o;case o:if(t===wi||t===c)break n;case w:if(i.last){nt>>>=g&7;g-=g&7;i.mode=k;break}while(g<3){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}i.last=nt&1;nt>>>=1;g-=1;switch(nt&3){case 0:i.mode=wt;break;case 1:if(fr(i),i.mode=a,t===c){nt>>>=2;g-=2;break n}break;case 2:i.mode=kt;break;case 3:n.msg="invalid block type";i.mode=r}nt>>>=2;g-=2;break;case wt:for(nt>>>=g&7,g-=g&7;g<32;){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}if((nt&65535)!=(nt>>>16^65535)){n.msg="invalid stored block lengths";i.mode=r;break}if(i.length=nt&65535,nt=0,g=0,i.mode=b,t===c)break n;case b:i.mode=bt;case bt:if(hi=i.length,hi){if(hi>si&&(hi=si),hi>rr&&(hi=rr),hi===0)break n;u.arraySet(lr,li,ci,hi,hr);si-=hi;ci+=hi;rr-=hi;hr+=hi;i.length-=hi;break}i.mode=o;break;case kt:while(g<14){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}if(i.nlen=(nt&31)+257,nt>>>=5,g-=5,i.ndist=(nt&31)+1,nt>>>=5,g-=5,i.ncode=(nt&15)+4,nt>>>=4,g-=4,i.nlen>286||i.ndist>30){n.msg="too many length or distance symbols";i.mode=r;break}i.have=0;i.mode=dt;case dt:while(i.have<i.ncode){while(g<3){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}i.lens[dr[i.have++]]=nt&7;nt>>>=3;g-=3}while(i.have<19)i.lens[dr[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,vr={bits:i.lenbits},cr=h(pi,i.lens,0,19,i.lencode,0,i.work,vr),i.lenbits=vr.bits,cr){n.msg="invalid code lengths set";i.mode=r;break}i.have=0;i.mode=gt;case gt:while(i.have<i.nlen+i.ndist){for(;;){if(tr=i.lencode[nt&(1<<i.lenbits)-1],ai=tr>>>24,er=tr>>>16&255,sr=tr&65535,ai<=g)break;if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}if(sr<16)nt>>>=ai,g-=ai,i.lens[i.have++]=sr;else{if(sr===16){for(ar=ai+2;g<ar;){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}if(nt>>>=ai,g-=ai,i.have===0){n.msg="invalid bit length repeat";i.mode=r;break}ir=i.lens[i.have-1];hi=3+(nt&3);nt>>>=2;g-=2}else if(sr===17){for(ar=ai+3;g<ar;){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}nt>>>=ai;g-=ai;ir=0;hi=3+(nt&7);nt>>>=3;g-=3}else{for(ar=ai+7;g<ar;){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}nt>>>=ai;g-=ai;ir=0;hi=11+(nt&127);nt>>>=7;g-=7}if(i.have+hi>i.nlen+i.ndist){n.msg="invalid bit length repeat";i.mode=r;break}while(hi--)i.lens[i.have++]=ir}}if(i.mode===r)break;if(i.lens[256]===0){n.msg="invalid code -- missing end-of-block";i.mode=r;break}if(i.lenbits=9,vr={bits:i.lenbits},cr=h(tt,i.lens,0,i.nlen,i.lencode,0,i.work,vr),i.lenbits=vr.bits,cr){n.msg="invalid literal/lengths set";i.mode=r;break}if(i.distbits=6,i.distcode=i.distdyn,vr={bits:i.distbits},cr=h(it,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,vr),i.distbits=vr.bits,cr){n.msg="invalid distances set";i.mode=r;break}if(i.mode=a,t===c)break n;case a:i.mode=v;case v:if(si>=6&&rr>=258){n.next_out=hr;n.avail_out=rr;n.next_in=ci;n.avail_in=si;i.hold=nt;i.bits=g;yi(n,nr);hr=n.next_out;lr=n.output;rr=n.avail_out;ci=n.next_in;li=n.input;si=n.avail_in;nt=i.hold;g=i.bits;i.mode===o&&(i.back=-1);break}for(i.back=0;;){if(tr=i.lencode[nt&(1<<i.lenbits)-1],ai=tr>>>24,er=tr>>>16&255,sr=tr&65535,ai<=g)break;if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}if(er&&(er&240)==0){for(or=ai,wr=er,br=sr;;){if(tr=i.lencode[br+((nt&(1<<or+wr)-1)>>or)],ai=tr>>>24,er=tr>>>16&255,sr=tr&65535,or+ai<=g)break;if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}nt>>>=or;g-=or;i.back+=or}if(nt>>>=ai,g-=ai,i.back+=ai,i.length=sr,er===0){i.mode=ui;break}if(er&32){i.back=-1;i.mode=o;break}if(er&64){n.msg="invalid literal/length code";i.mode=r;break}i.extra=er&15;i.mode=ni;case ni:if(i.extra){for(ar=i.extra;g<ar;){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}i.length+=nt&(1<<i.extra)-1;nt>>>=i.extra;g-=i.extra;i.back+=i.extra}i.was=i.length;i.mode=ti;case ti:for(;;){if(tr=i.distcode[nt&(1<<i.distbits)-1],ai=tr>>>24,er=tr>>>16&255,sr=tr&65535,ai<=g)break;if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}if((er&240)==0){for(or=ai,wr=er,br=sr;;){if(tr=i.distcode[br+((nt&(1<<or+wr)-1)>>or)],ai=tr>>>24,er=tr>>>16&255,sr=tr&65535,or+ai<=g)break;if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}nt>>>=or;g-=or;i.back+=or}if(nt>>>=ai,g-=ai,i.back+=ai,er&64){n.msg="invalid distance code";i.mode=r;break}i.offset=sr;i.extra=er&15;i.mode=ii;case ii:if(i.extra){for(ar=i.extra;g<ar;){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}i.offset+=nt&(1<<i.extra)-1;nt>>>=i.extra;g-=i.extra;i.back+=i.extra}if(i.offset>i.dmax){n.msg="invalid distance too far back";i.mode=r;break}i.mode=ri;case ri:if(rr===0)break n;if(hi=nr-rr,i.offset>hi){if(hi=i.offset-hi,hi>i.whave&&i.sane){n.msg="invalid distance too far back";i.mode=r;break}hi>i.wnext?(hi-=i.wnext,pr=i.wsize-hi):pr=i.wnext-hi;hi>i.length&&(hi=i.length);kr=i.window}else kr=lr,pr=hr-i.offset,hi=i.length;hi>rr&&(hi=rr);rr-=hi;i.length-=hi;do lr[hr++]=kr[pr++];while(--hi);i.length===0&&(i.mode=v);break;case ui:if(rr===0)break n;lr[hr++]=i.length;rr--;i.mode=v;break;case k:if(i.wrap){while(g<32){if(si===0)break n;si--;nt|=li[ci++]<<g;g+=8}if(nr-=rr,n.total_out+=nr,i.total+=nr,nr&&(n.adler=i.check=i.flags?e(i.check,lr,nr,hr-nr):y(i.check,lr,nr,hr-nr)),nr=rr,(i.flags?nt:oi(nt))!==i.check){n.msg="incorrect data check";i.mode=r;break}nt=0;g=0}i.mode=fi;case fi:if(i.wrap&&i.flags){while(g<32){if(si===0)break n;si--;nt+=li[ci++]<<g;g+=8}if(nt!==(i.total&4294967295)){n.msg="incorrect length check";i.mode=r;break}nt=0;g=0}i.mode=ei;case ei:cr=bi;break n;case r:cr=ut;break n;case d:return p;case gi:default:return f}return(n.next_out=hr,n.avail_out=rr,n.next_in=ci,n.avail_in=si,i.hold=nt,i.bits=g,(i.wsize||nr!==n.avail_out&&i.mode<r&&(i.mode<k||t!==rt))&&vi(n,n.output,n.next_out,nr-n.avail_out))?(i.mode=d,p):(yr-=n.avail_in,nr-=n.avail_out,n.total_in+=yr,n.total_out+=nr,i.total+=nr,i.wrap&&nr&&(n.adler=i.check=i.flags?e(i.check,lr,nr,n.next_out-nr):y(i.check,lr,nr,n.next_out-nr)),n.data_type=i.bits+(i.last?64:0)+(i.mode===o?128:0)+(i.mode===a||i.mode===b?256:0),(yr===0&&nr===0||t===rt)&&cr===s&&(cr=di),cr)}function or(n){if(!n||!n.state)return f;var t=n.state;return t.window&&(t.window=null),n.state=null,s}function sr(n,t){var i;return!n||!n.state?f:(i=n.state,(i.wrap&2)==0)?f:(i.head=t,t.done=!1,s)}function hr(n,t){var u=t.length,i,r,e;return!n||!n.state?f:(i=n.state,i.wrap!==0&&i.mode!==l)?f:i.mode===l&&(r=1,r=y(r,t,u,0),r!==i.check)?ut:(e=vi(n,t,u,u),e)?(i.mode=d,p):(i.havedict=1,s)}var u=i("./node_modules/pako/lib/utils/common.js"),y=i("./node_modules/pako/lib/zlib/adler32.js"),e=i("./node_modules/pako/lib/zlib/crc32.js"),yi=i("./node_modules/pako/lib/zlib/inffast.js"),h=i("./node_modules/pako/lib/zlib/inftrees.js"),pi=0,tt=1,it=2,rt=4,wi=5,c=6,s=0,bi=1,ki=2,f=-2,ut=-3,p=-4,di=-5,ft=8,et=1,ot=2,st=3,ht=4,ct=5,lt=6,at=7,vt=8,yt=9,pt=10,l=11,o=12,w=13,wt=14,b=15,bt=16,kt=17,dt=18,gt=19,a=20,v=21,ni=22,ti=23,ii=24,ri=25,ui=26,k=27,fi=28,ei=29,r=30,d=31,gi=32,nr=852,tr=592,ir=15,ai=!0,g,nt;t.inflateReset=hi;t.inflateReset2=ci;t.inflateResetKeep=si;t.inflateInit=ur;t.inflateInit2=li;t.inflate=er;t.inflateEnd=or;t.inflateGetHeader=sr;t.inflateSetDictionary=hr;t.inflateInfo="pako inflate (from Nodeca project)"},"./node_modules/pako/lib/zlib/inftrees.js":function(n,t,i){"use strict";var f=i("./node_modules/pako/lib/utils/common.js"),r=15,e=852,o=592,s=0,u=1,h=2,c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],v=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(n,t,i,y,p,w,b,k){for(var ii=k.bits,d=0,g=0,ut=0,nt=0,tt=0,ft=0,it=0,et=0,ht=0,rt=0,ot,ct,vt,dt,lt,yt=null,gt=0,at,st=new f.Buf16(r+1),pt=new f.Buf16(r+1),wt=null,ni=0,ti,bt,kt,d=0;d<=r;d++)st[d]=0;for(g=0;g<y;g++)st[t[i+g]]++;for(tt=ii,nt=r;nt>=1;nt--)if(st[nt]!==0)break;if(tt>nt&&(tt=nt),nt===0)return p[w++]=20971520,p[w++]=20971520,k.bits=1,0;for(ut=1;ut<nt;ut++)if(st[ut]!==0)break;for(tt<ut&&(tt=ut),et=1,d=1;d<=r;d++)if(et<<=1,et-=st[d],et<0)return-1;if(et>0&&(n===s||nt!==1))return-1;for(pt[1]=0,d=1;d<r;d++)pt[d+1]=pt[d]+st[d];for(g=0;g<y;g++)t[i+g]!==0&&(b[pt[t[i+g]]++]=g);if(n===s?(yt=wt=b,at=19):n===u?(yt=c,gt-=257,wt=l,ni-=257,at=256):(yt=a,wt=v,at=-1),rt=0,g=0,d=ut,lt=w,ft=tt,it=0,vt=-1,ht=1<<tt,dt=ht-1,n===u&&ht>e||n===h&&ht>o)return 1;for(;;){ti=d-it;b[g]<at?(bt=0,kt=b[g]):b[g]>at?(bt=wt[ni+b[g]],kt=yt[gt+b[g]]):(bt=96,kt=0);ot=1<<d-it;ct=1<<ft;ut=ct;do ct-=ot,p[lt+(rt>>it)+ct]=ti<<24|bt<<16|kt|0;while(ct!==0);for(ot=1<<d-1;rt&ot;)ot>>=1;if(ot!==0?(rt&=ot-1,rt+=ot):rt=0,g++,--st[d]==0){if(d===nt)break;d=t[i+b[g]]}if(d>tt&&(rt&dt)!==vt){for(it===0&&(it=tt),lt+=ut,ft=d-it,et=1<<ft;ft+it<nt;){if(et-=st[ft+it],et<=0)break;ft++;et<<=1}if(ht+=1<<ft,n===u&&ht>e||n===h&&ht>o)return 1;vt=rt&dt;p[vt]=tt<<24|ft<<16|lt-w|0}}return rt!==0&&(p[lt+rt]=d-it<<24|4194304),k.bits=tt,0}},"./node_modules/pako/lib/zlib/messages.js":function(n){"use strict";n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"./node_modules/pako/lib/zlib/trees.js":function(n,t,i){"use strict";function o(n){for(var t=n.length;--t>=0;)n[t]=0}function it(n,t,i,r,u){this.static_tree=n;this.extra_bits=t;this.extra_base=i;this.elems=r;this.max_length=u;this.has_stree=n&&n.length}function rt(n,t){this.dyn_tree=n;this.max_code=0;this.stat_desc=t}function kt(n){return n<256?c[n]:c[256+(n>>>7)]}function p(n,t){n.pending_buf[n.pending++]=t&255;n.pending_buf[n.pending++]=t>>>8&255}function r(n,t,i){n.bi_valid>g-i?(n.bi_buf|=t<<n.bi_valid&65535,p(n,n.bi_buf),n.bi_buf=t>>g-n.bi_valid,n.bi_valid+=i-g):(n.bi_buf|=t<<n.bi_valid&65535,n.bi_valid+=i)}function u(n,t,i){r(n,i[t*2],i[t*2+1])}function dt(n,t){var i=0;do i|=n&1,n>>>=1,i<<=1;while(--t>0);return i>>>1}function yi(n){n.bi_valid===16?(p(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)}function pi(n,t){for(var u=t.dyn_tree,a=t.max_code,y=t.stat_desc.static_tree,p=t.stat_desc.has_stree,w=t.stat_desc.extra_bits,v=t.stat_desc.extra_base,o=t.stat_desc.max_length,s,r,f,h,l,c=0,i=0;i<=e;i++)n.bl_count[i]=0;for(u[n.heap[n.heap_max]*2+1]=0,s=n.heap_max+1;s<ct;s++)(r=n.heap[s],i=u[u[r*2+1]*2+1]+1,i>o&&(i=o,c++),u[r*2+1]=i,r>a)||(n.bl_count[i]++,h=0,r>=v&&(h=w[r-v]),l=u[r*2],n.opt_len+=l*(i+h),p&&(n.static_len+=l*(y[r*2+1]+h)));if(c!==0){do{for(i=o-1;n.bl_count[i]===0;)i--;n.bl_count[i]--;n.bl_count[i+1]+=2;n.bl_count[o]--;c-=2}while(c>0);for(i=o;i!==0;i--)for(r=n.bl_count[i];r!==0;)(f=n.heap[--s],f>a)||(u[f*2+1]!==i&&(n.opt_len+=(i-u[f*2+1])*u[f*2],u[f*2+1]=i),r--)}}function gt(n,t,i){for(var o=new Array(e+1),s=0,u,f,r=1;r<=e;r++)o[r]=s=s+i[r-1]<<1;for(u=0;u<=t;u++)(f=n[u*2+1],f!==0)&&(n[u*2]=dt(o[f]++,f))}function wi(){for(var n,u,i,r=new Array(e+1),o=0,t=0;t<k-1;t++)for(b[t]=o,n=0;n<1<<tt[t];n++)l[o++]=t;for(l[o-1]=t,i=0,t=0;t<16;t++)for(y[t]=i,n=0;n<1<<w[t];n++)c[i++]=t;for(i>>=7;t<s;t++)for(y[t]=i<<7,n=0;n<1<<w[t]-7;n++)c[256+i++]=t;for(u=0;u<=e;u++)r[u]=0;for(n=0;n<=143;)f[n*2+1]=8,n++,r[8]++;while(n<=255)f[n*2+1]=9,n++,r[9]++;while(n<=279)f[n*2+1]=7,n++,r[7]++;while(n<=287)f[n*2+1]=8,n++,r[8]++;for(gt(f,v+1,r),n=0;n<s;n++)h[n*2+1]=5,h[n*2]=dt(n,5);pt=new it(f,tt,a+1,v,e);wt=new it(h,w,0,s,e);bt=new it(new Array(0),vi,0,d,ai)}function ni(n){for(var t=0;t<v;t++)n.dyn_ltree[t*2]=0;for(t=0;t<s;t++)n.dyn_dtree[t*2]=0;for(t=0;t<d;t++)n.bl_tree[t*2]=0;n.dyn_ltree[nt*2]=1;n.opt_len=n.static_len=0;n.last_lit=n.matches=0}function ti(n){n.bi_valid>8?p(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf);n.bi_buf=0;n.bi_valid=0}function bi(n,t,i,r){ti(n);r&&(p(n,i),p(n,~i));oi.arraySet(n.pending_buf,n.window,t,i,n.pending);n.pending+=i}function ii(n,t,i,r){var u=t*2,f=i*2;return n[u]<n[f]||n[u]===n[f]&&r[t]<=r[i]}function ut(n,t,i){for(var u=n.heap[i],r=i<<1;r<=n.heap_len;){if(r<n.heap_len&&ii(t,n.heap[r+1],n.heap[r],n.depth)&&r++,ii(t,u,n.heap[r],n.depth))break;n.heap[i]=n.heap[r];i=r;r<<=1}n.heap[i]=u}function ri(n,t,i){var e,s,h=0,f,o;if(n.last_lit!==0)do e=n.pending_buf[n.d_buf+h*2]<<8|n.pending_buf[n.d_buf+h*2+1],s=n.pending_buf[n.l_buf+h],h++,e===0?u(n,s,t):(f=l[s],u(n,f+a+1,t),o=tt[f],o!==0&&(s-=b[f],r(n,s,o)),e--,f=kt(e),u(n,f,i),o=w[f],o!==0&&(e-=y[f],r(n,e,o)));while(h<n.last_lit);u(n,nt,t)}function ft(n,t){var r=t.dyn_tree,s=t.stat_desc.static_tree,h=t.stat_desc.has_stree,o=t.stat_desc.elems,i,f,e=-1,u;for(n.heap_len=0,n.heap_max=ct,i=0;i<o;i++)r[i*2]!==0?(n.heap[++n.heap_len]=e=i,n.depth[i]=0):r[i*2+1]=0;while(n.heap_len<2)u=n.heap[++n.heap_len]=e<2?++e:0,r[u*2]=1,n.depth[u]=0,n.opt_len--,h&&(n.static_len-=s[u*2+1]);for(t.max_code=e,i=n.heap_len>>1;i>=1;i--)ut(n,r,i);u=o;do i=n.heap[1],n.heap[1]=n.heap[n.heap_len--],ut(n,r,1),f=n.heap[1],n.heap[--n.heap_max]=i,n.heap[--n.heap_max]=f,r[u*2]=r[i*2]+r[f*2],n.depth[u]=(n.depth[i]>=n.depth[f]?n.depth[i]:n.depth[f])+1,r[i*2+1]=r[f*2+1]=u,n.heap[1]=u++,ut(n,r,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1];pi(n,t);gt(r,e,n.bl_count)}function ui(n,t,i){var s,h=-1,r,u=t[1],f=0,e=7,o=4;for(u===0&&(e=138,o=3),t[(i+1)*2+1]=65535,s=0;s<=i;s++){if(r=u,u=t[(s+1)*2+1],++f<e&&r===u)continue;else f<o?n.bl_tree[r*2]+=f:r!==0?(r!==h&&n.bl_tree[r*2]++,n.bl_tree[lt*2]++):f<=10?n.bl_tree[at*2]++:n.bl_tree[vt*2]++;f=0;h=r;u===0?(e=138,o=3):r===u?(e=6,o=3):(e=7,o=4)}}function fi(n,t,i){var c,l=-1,e,o=t[1],f=0,s=7,h=4;for(o===0&&(s=138,h=3),c=0;c<=i;c++){if(e=o,o=t[(c+1)*2+1],++f<s&&e===o)continue;else if(f<h){do u(n,e,n.bl_tree);while(--f!=0)}else e!==0?(e!==l&&(u(n,e,n.bl_tree),f--),u(n,lt,n.bl_tree),r(n,f-3,2)):f<=10?(u(n,at,n.bl_tree),r(n,f-3,3)):(u(n,vt,n.bl_tree),r(n,f-11,7));f=0;l=e;o===0?(s=138,h=3):e===o?(s=6,h=3):(s=7,h=4)}}function ki(n){var t;for(ui(n,n.dyn_ltree,n.l_desc.max_code),ui(n,n.dyn_dtree,n.d_desc.max_code),ft(n,n.bl_desc),t=d-1;t>=3;t--)if(n.bl_tree[yt[t]*2+1]!==0)break;return n.opt_len+=3*(t+1)+5+5+4,t}function di(n,t,i,u){var f;for(r(n,t-257,5),r(n,i-1,5),r(n,u-4,4),f=0;f<u;f++)r(n,n.bl_tree[yt[f]*2+1],3);fi(n,n.dyn_ltree,t-1);fi(n,n.dyn_dtree,i-1)}function gi(n){for(var i=4093624447,t=0;t<=31;t++,i>>>=1)if(i&1&&n.dyn_ltree[t*2]!==0)return ot;if(n.dyn_ltree[18]!==0||n.dyn_ltree[20]!==0||n.dyn_ltree[26]!==0)return st;for(t=32;t<a;t++)if(n.dyn_ltree[t*2]!==0)return st;return ot}function nr(n){et||(wi(),et=!0);n.l_desc=new rt(n.dyn_ltree,pt);n.d_desc=new rt(n.dyn_dtree,wt);n.bl_desc=new rt(n.bl_tree,bt);n.bi_buf=0;n.bi_valid=0;ni(n)}function ei(n,t,i,u){r(n,(ci<<1)+(u?1:0),3);bi(n,t,i,!0)}function tr(n){r(n,ht<<1,3);u(n,nt,f);yi(n)}function ir(n,t,i,u){var e,o,s=0;n.level>0?(n.strm.data_type===hi&&(n.strm.data_type=gi(n)),ft(n,n.l_desc),ft(n,n.d_desc),s=ki(n),e=n.opt_len+3+7>>>3,o=n.static_len+3+7>>>3,o<=e&&(e=o)):e=o=i+5;i+4<=e&&t!==-1?ei(n,t,i,u):n.strategy===si||o===e?(r(n,(ht<<1)+(u?1:0),3),ri(n,f,h)):(r(n,(li<<1)+(u?1:0),3),di(n,n.l_desc.max_code+1,n.d_desc.max_code+1,s+1),ri(n,n.dyn_ltree,n.dyn_dtree));ni(n);u&&ti(n)}function rr(n,t,i){return n.pending_buf[n.d_buf+n.last_lit*2]=t>>>8&255,n.pending_buf[n.d_buf+n.last_lit*2+1]=t&255,n.pending_buf[n.l_buf+n.last_lit]=i&255,n.last_lit++,t===0?n.dyn_ltree[i*2]++:(n.matches++,t--,n.dyn_ltree[(l[i]+a+1)*2]++,n.dyn_dtree[kt(t)*2]++),n.last_lit===n.lit_bufsize-1}var oi=i("./node_modules/pako/lib/utils/common.js"),si=4,ot=0,st=1,hi=2,ci=0,ht=1,li=2,k=29,a=256,v=a+1+k,s=30,d=19,ct=2*v+1,e=15,g=16,ai=7,nt=256,lt=16,at=17,vt=18,tt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],vi=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],yt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array((v+2)*2),h,c,l,b,y,pt,wt,bt,et;o(f);h=new Array(s*2);o(h);c=new Array(512);o(c);l=new Array(256);o(l);b=new Array(k);o(b);y=new Array(s);o(y);et=!1;t._tr_init=nr;t._tr_stored_block=ei;t._tr_flush_block=ir;t._tr_tally=rr;t._tr_align=tr},"./node_modules/pako/lib/zlib/zstream.js":function(n){"use strict";function t(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}n.exports=t},"./node_modules/process/browser.js":function(n){function h(){throw new Error("setTimeout has not been defined");}function c(){throw new Error("clearTimeout has not been defined");}function l(n){if(i===setTimeout)return setTimeout(n,0);if((i===h||!i)&&setTimeout)return i=setTimeout,setTimeout(n,0);try{return i(n,0)}catch(t){try{return i.call(null,n,0)}catch(t){return i.call(this,n,0)}}}function y(n){if(r===clearTimeout)return clearTimeout(n);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n);try{return r(n)}catch(t){try{return r.call(null,n)}catch(t){return r.call(this,n)}}}function p(){o&&e&&(o=!1,e.length?u=e.concat(u):s=-1,u.length&&a())}function a(){var t,n;if(!o){for(t=l(p),o=!0,n=u.length;n;){for(e=u,u=[];++s<n;)e&&e[s].run();s=-1;n=u.length}e=null;o=!1;y(t)}}function v(n,t){this.fun=n;this.array=t}function f(){}var t=n.exports={},i,r;(function(){try{i=typeof setTimeout=="function"?setTimeout:h}catch(n){i=h}try{r=typeof clearTimeout=="function"?clearTimeout:c}catch(n){r=c}})();var u=[],o=!1,e,s=-1;t.nextTick=function(n){var i=new Array(arguments.length-1),t;if(arguments.length>1)for(t=1;t<arguments.length;t++)i[t-1]=arguments[t];u.push(new v(n,i));u.length!==1||o||l(a)};v.prototype.run=function(){this.fun.apply(null,this.array)};t.title="browser";t.browser=!0;t.env={};t.argv=[];t.version="";t.versions={};t.on=f;t.addListener=f;t.once=f;t.off=f;t.removeListener=f;t.removeAllListeners=f;t.emit=f;t.prependListener=f;t.prependOnceListener=f;t.listeners=function(){return[]};t.binding=function(){throw new Error("process.binding is not supported");};t.cwd=function(){return"/"};t.chdir=function(){throw new Error("process.chdir is not supported");};t.umask=function(){return 0}},"./src/annotation.ts":function(n,t,i){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0});const r=i("./src/parser.ts"),u=i("./src/util.ts"),e=i("./src/writer.ts");class f{constructor(n){this.data=n;this.annotations=[];this.toDelete=[];this.data=n;this.parser=new r.PDFDocumentParser(this.data)}getAnnotationCount(){return this.annotations.length}static loadFile(t){return new Promise(i=>{if(typeof window!="undefined")fetch(t).then(n=>n.blob()).then(n=>{let t=new FileReader;t.onload=()=>{i(new f(t.result))};t.readAsArrayBuffer(n)});else if(typeof n=="object")throw Error("Not yet implemented");else throw Error("Unsupported environment");})}generateUniqueIdentifier(){return"(pdfAnnotate-"+u.Util.convertDateToPDFDate(new Date).slice(3,17)+"-"+this.annotations.length+")"}createDefaultBorder(){return{vertical_corner_radius:0,horizontal_corner_radius:0,border_width:1}}write(){if(this.annotations.length===0&&this.toDelete.length===0)return this.data;let n=new e.Writer(this.data,this.annotations,this.toDelete,this.parser);return n.write()}checkRect(n,t){if(t.length!==n)throw Error("Rect has invalid number of entries: "+t+" has "+t.length+" entries, but should have "+n+" entries");t.forEach(n=>{if("number"!=typeof n)throw Error("Rect "+t+" has invalid entry: "+n);})}extractRectFromQuadPoints(n){let t=n.filter((n,t)=>t%2==0),i=n.filter((n,t)=>t%2!=0);return[Math.min(...t),Math.min(...i),Math.max(...t),Math.max(...i)]}checkQuadPoints(n){if(n.length%8!=0)throw Error(`Quadpoints array has length ${n.length} but must be a multiple of 8`);n.forEach(t=>{if("number"!=typeof t)throw Error("Quadpoint "+n+" has invalid entry: "+t);})}createBaseAnnotation(n,t,i,f){let e=new r.Annotation;return e.type="/Annot",e.page=n,e.object_id=this.parser.getFreeObjectId(),e.id=this.generateUniqueIdentifier(),e.rect=t,e.author=f,e.pageReference=this.parser.getPage(n),e.updateDate=u.Util.convertDateToPDFDate(new Date),e.contents=i,e.border=this.createDefaultBorder(),e}createTextAnnotation(n,t,i,r,u={r:1,g:1,b:0}){i||(i="");r||(r="");this.checkRect(4,t);let f=Object.assign(this.createBaseAnnotation(n,t,i,r),{opacity:1,initiallyOpen:!1,annotation_flag:4,color:u});f.type="/Text";this.annotations.push(f)}createTextMarkupAnnotation(n,t,i,r,u,f={r:1,g:1,b:0},e=[]){0===e.length?e=[t[0],t[3],t[2],t[3],t[0],t[1],t[2],t[1]]:this.checkQuadPoints(e);let o=Object.assign(this.createBaseAnnotation(n,t,i,r),{opacity:1,initiallyOpen:!1,annotation_flag:4,color:f,quadPoints:e});return o.type=u,o}createHighlightAnnotation(n,t,i,r,u={r:1,g:1,b:0},f=[]){this.checkQuadPoints(f);t.length===0&&f.length>0&&(t=this.extractRectFromQuadPoints(f));this.checkRect(4,t);let e=this.createTextMarkupAnnotation(n,t,i,r,"/Highlight",u,f);this.annotations.push(e)}createUnderlineAnnotation(n,t,i,r,u={r:1,g:1,b:0},f=[]){this.checkQuadPoints(f);t.length===0&&f.length>0&&(t=this.extractRectFromQuadPoints(f));this.checkRect(4,t);let e=this.createTextMarkupAnnotation(n,t,i,r,"/Underline",u,f);this.annotations.push(e)}createSquigglyAnnotation(n,t,i,r,u={r:1,g:1,b:0},f=[]){this.checkQuadPoints(f);t.length===0&&f.length>0&&(t=this.extractRectFromQuadPoints(f));this.checkRect(4,t);let e=this.createTextMarkupAnnotation(n,t,i,r,"/Squiggly",u,f);this.annotations.push(e)}createStrikeOutAnnotation(n,t,i,r,u={r:1,g:1,b:0},f=[]){this.checkQuadPoints(f);t.length===0&&f.length>0&&(t=this.extractRectFromQuadPoints(f));this.checkRect(4,t);let e=this.createTextMarkupAnnotation(n,t,i,r,"/StrikeOut",u,f);this.annotations.push(e)}createFreeTextAnnotation(n,t,i,r){this.checkRect(4,t);let u=Object.assign(this.createBaseAnnotation(n,t,i,r),{textAlignment:"right-justified",defaultAppearance:"/Invalid_font 9 Tf"});u.type="/FreeText";this.annotations.push(u)}createLineAnnotation(){throw Error("No yet implemented");}createSquareCircleAnnotation(n,t,i,r,u,f={r:1,g:1,b:0}){let e=Object.assign(this.createBaseAnnotation(n,t,i,r),{opacity:1,initiallyOpen:!1,annotation_flag:4,color:f});return e.type=u,e}createSquareAnnotation(n,t,i,r,u={r:1,g:1,b:0}){this.checkRect(4,t);let f=this.createSquareCircleAnnotation(n,t,i,r,"/Square",u);this.annotations.push(f)}createCircleAnnotation(n,t,i,r,u={r:1,g:1,b:0}){this.checkRect(4,t);let f=this.createSquareCircleAnnotation(n,t,i,r,"/Circle",u);this.annotations.push(f)}createPolygonPolyLineAnnotation(n,t,i,r,u,f,e={r:1,g:1,b:0}){let o=Object.assign(this.createBaseAnnotation(n,t,i,r),{opacity:1,initiallyOpen:!1,annotation_flag:4,color:e,vertices:u});return o.type=f,o}createPolygonAnnotation(n,t,i,r,u,f={r:1,g:1,b:0}){this.checkRect(4,t);let e=this.createPolygonPolyLineAnnotation(n,t,i,r,u,"/Polygon",f);this.annotations.push(e)}createPolyLineAnnotation(n,t,i,r,u,f={r:1,g:1,b:0}){this.checkRect(4,t);let e=this.createPolygonPolyLineAnnotation(n,t,i,r,u,"/PolyLine",f);this.annotations.push(e)}createInkAnnotation(n,t,i,r,u,f={r:0,g:1,b:0}){if(u.length===0)throw Error("InkList is empty");let e=[];e="number"==typeof u[0]?[u]:u;let o=Object.assign(this.createBaseAnnotation(n,t,i,r),{opacity:1,initiallyOpen:!1,annotation_flag:4,color:f,inkList:e});o.type="/Ink";this.annotations.push(o)}createStampAnnotation(n,t,i,r="Draft",u={r:1,g:1,b:0}){let f=Object.assign(this.createBaseAnnotation(n,[50,50,80,80],t,i),{opacity:1,initiallyOpen:!1,annotation_flag:4,color:u,stampType:r});f.type="/Stamp";this.annotations.push(f)}createCaretAnnotation(n,t,i,r="P",u={r:1,g:1,b:0}){let f=Object.assign(this.createBaseAnnotation(n,[],t,i),{opacity:1,initiallyOpen:!1,annotation_flag:4,color:u,caretSymbol:r});f.type="/Caret";this.annotations.push(f)}deleteAnnotation(n){return new Promise(t=>{for(let i=0;i<this.annotations.length;++i){if("string"==typeof n&&this.annotations[i].id===n){this.annotations=this.annotations.slice(i,1);t(this.toDelete);return}if(n.obj&&this.annotations[i].object_id&&n.obj===this.annotations[i].object_id.obj&&n.generation&&n.generation===this.annotations[i].object_id.generation){this.annotations=this.annotations.slice(i,1);t(this.toDelete);return}}this.getAnnotations().then(i=>{for(let i of i)for(let i of i){if("string"==typeof n&&i.id===n){this.toDelete.push(i);t(this.toDelete);return}if(n.obj&&i.object_id&&n.obj===i.object_id.obj&&n.generation&&n.generation===i.object_id.generation){this.toDelete.push(i);t(this.toDelete);return}}})})}getAnnotations(){return new Promise(n=>{let t=this.parser.extractAnnotations();for(let n of this.annotations)t[n.page].push(n);n(t)})}createPopupAnnotation(){throw Error("No yet implemented");}download(n="output.pdf"){let t=document.createElement("a");document.body.appendChild(t);t.style="display: none";let r=this.write(),u=new Blob([r],{type:"application/pdf"}),i=window.URL.createObjectURL(u);t.href=i;t.download=n;t.click();t.remove();window.URL.revokeObjectURL(i)}save(){}}t.AnnotationFactory=f}).call(this,i("./node_modules/process/browser.js"))},"./src/array-util.ts":function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./src/util.ts"),f=i("./src/object-util.ts");class u{static extractArray(n,t){if(t=r.Util.skipSpaces(n,t),n[t]!==r.Util.ARRAY_START[0])throw Error("Invalid array sequence -- does not start with '['");t+=1;let o=r.Util.readNextWord(n,t),e=o.result,i=[];while(e){if(e[0]===r.Util.ARRAY_START[0]){let r=u.extractArray(n,t);t=r.end_index;i.push(r.result)}else if(r.Util.areArraysEqual(e,r.Util.NULL))i.push("null"),t+=e.length-1;else{if(e[0]===r.Util.LITERAL_STRING_END[0])return{result:i,end_index:o.end_index};if(e[0]===r.Util.LITERAL_STRING_START[0]){let u=r.Util.extractString(n,t);i.push(u.result);t=u.end_index}else if(e[0]===r.Util.DICT_START[0]){let u=r.Util.readNextWord(n,o.end_index+1);if(u.result&&u.result[0]===r.Util.DICT_START[0]){let r={};t=f.ObjectUtil.extractDictValueRec(n,t,r);i.push(r)}else{let u=r.Util.extractHexString(n,t);i.push(u.result);t=u.end_index}}else if(e[0]===47){let u=r.Util.extractOptionValue(n,t);i.push("/"+u.result);t=u.end_index}else if(e[0]===r.Util.R[0]){let n=i[i.length-2],r=i[i.length-1];i=i.slice(0,i.length-2);i.push({obj:n,generation:r});t=o.end_index}else if(e[0]===r.Util.ARRAY_END[0])break;else{let u=r.Util.extractNumber(n,t);i.push(u.result);t=u.end_index}}++t;t=r.Util.skipSpaces(n,t);o=r.Util.readNextWord(n,t);e=o.result}return{result:i,end_index:o.end_index}}}t.ArrayUtil=u},"./src/document-history.ts":function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./src/util.ts"),e=i("./src/object-util.ts");class u{constructor(n){this.data=n;this.refs=[];this.trailer={size:-1,root:{obj:-1,generation:-1}};this.streamLength=-1;this.w=[];this.index=[];this.start_pointer=0}extractCrossReferenceSection(n,t,i){let r=n;for(let n=0;n<t;++n){let t=i.getNBytesAsNumber(this.w[0]),n=undefined;switch(t){case 0:n={id:r++,pointer:i.getNBytesAsNumber(this.w[1]),generation:this.w[2]===0?0:i.getNBytesAsNumber(this.w[2]),free:!0,update:!1};break;case 1:n={id:r++,pointer:i.getNBytesAsNumber(this.w[1]),generation:this.w[2]===0?0:i.getNBytesAsNumber(this.w[2]),free:!1,update:!0};break;case 2:n={id:r++,pointer:i.getNBytesAsNumber(this.w[1]),generation:this.w[2]===0?0:i.getNBytesAsNumber(this.w[2]),free:!0,update:!1,compressed:!0}}if(n)this.refs.push(n);else throw Error(`Invalid cross-reference-stream type ${t}`);}}extractStream(n){let t=this.w.reduce((n,t)=>n+t,0);if(n.getLength()!==t*this.index.filter((n,t)=>t%2==1).reduce((n,t)=>n+t,0))throw Error(`Invalid stream length - is ${n.getLength()} but should be ${t*this.index.filter((n,t)=>t%2==1).reduce((n,t)=>n+t,0)}`);if(this.index.length%2==1)throw Error(`Invalid index flag ${this.index}`);for(let t=0;t<this.index.length;t+=2)this.extractCrossReferenceSection(this.index[t],this.index[t+1],n)}extract(n){let i=n.pointer;this.start_pointer=i;let t=e.ObjectUtil.extractObject(this.data,n),f=r.Util.locateSequence(r.Util.ENDOBJ,this.data,i);if(this.data=this.data.slice(i,f),t.value["/Type"]!=="/XRef")throw Error(`Invalid Cross-Reference-Stream-object type: ${t.value["/Type"]}`);if(!t.value["/Size"])throw Error(`Invalid size value ${t.value["/Size"]}`);if(this.trailer.size=t.value["/Size"],t.value["/Root"]&&(this.trailer.root=t.value["/Root"]),t.value["/Prev"]&&(this.trailer.prev=t.value["/Prev"]),this.w=t.value["/W"],!this.w||0===this.w.length)throw Error("Invalid /W parameter in Cross-Reference-Stream-Object");if(this.index=t.value["/Index"],this.index&&0!==this.index.length||(this.index=[0,t.value["/Size"]]),!t.stream)throw Error("Missing stream at cross reference stream object");let u=t.stream;if(!u)throw Error("Invalid stream object");this.streamLength=t.value["/Length"];this.extractStream(u);this.refs.push({id:t.id.obj,pointer:this.start_pointer,generation:t.id.generation,free:!1,update:!0})}getUpdateSection(){return{start_pointer:this.start_pointer,size:this.trailer.size,prev:this.trailer.prev,root:this.trailer.root,refs:this.refs}}}t.CrossReferenceStreamObject=u;class f{constructor(n){this.data=n;this.refs=[];this.start_pointer=-1;this.trailer={size:-1,root:{obj:-1,generation:-1}}}getReference(n){for(let t of this.refs)if(t.id===n)return t;return undefined}getUpdateSection(){return{start_pointer:this.start_pointer,size:this.trailer.size,refs:this.refs,prev:this.trailer.prev,root:this.trailer.root}}extractSubSectionHeader(n){let t=r.Util.locateDelimiter(this.data,n),i=r.Util.extractNumber(this.data,n,t).result;t=r.Util.skipDelimiter(this.data,t+1);let u=t;t=r.Util.locateDelimiter(this.data,t);let f=r.Util.extractNumber(this.data,u,t).result;return{id:i,count:f,end_ptr:t}}extractReferences(n,t,i){let u=[];for(let f=0;f<t;++f,n+=20){let t=r.Util.locateDelimiter(this.data,n),h=r.Util.extractNumber(this.data,n,t).result,e=r.Util.skipDelimiter(this.data,t+1),o=r.Util.locateDelimiter(this.data,e),c=r.Util.extractNumber(this.data,e,o).result,l=r.Util.skipDelimiter(this.data,o+1),s=this.data[l]===102;u.push({id:i+f,pointer:h,generation:c,free:s,update:!s})}return u}extractTrailer(n){let o=r.Util.locateSequence(r.Util.STARTXREF,this.data,n,!0),t=this.data.slice(n,o);n=0;let u=r.Util.locateSequence(r.Util.SIZE,t,n,!0)+r.Util.SIZE.length;u=r.Util.skipDelimiter(t,u);let s=r.Util.extractNumber(t,u).result,f=r.Util.locateSequence(r.Util.ROOT,t,n,!0)+r.Util.ROOT.length;f=r.Util.skipDelimiter(t,f);let h=r.Util.extractReferenceTyped(t,f),i=r.Util.locateSequence(r.Util.PREV,t,n,!0),e=undefined;return-1!=i&&(i=r.Util.skipDelimiter(t,i+r.Util.PREV.length),e=r.Util.extractNumber(t,i).result),{size:s,root:h.result,prev:e}}extract(n){this.start_pointer=n;let t=n+5;t=r.Util.skipDelimiter(this.data,t);let u=this.extractSubSectionHeader(t),i=r.Util.skipDelimiter(this.data,u.end_ptr+1);for(this.refs=this.refs.concat(this.extractReferences(i,u.count,u.id)),t=i+u.count*20;this.data[t]!==116;){let n=this.extractSubSectionHeader(t);i=r.Util.skipDelimiter(this.data,n.end_ptr+1);let u=this.extractReferences(i,n.count,n.id);this.refs=this.refs.concat(u);t=i+n.count*20}this.trailer=this.extractTrailer(t)}}t.CrossReferenceTable=f;class o{constructor(n){this.data=n;this.updates=[];this.trailerSize=-1;this.already_reused_ids=[];this.data=new Uint8Array(n)}extractCrossReferenceTable(n){let t=new f(this.data);return t.extract(n),t}extractCrossReferenceStreamObject(n){let t=new u(this.data);return t.extract(n),t}extractDocumentEntry(){let n=this.data.length-1,t=r.Util.locateSequenceReversed(r.Util.STARTXREF,this.data,n,!0)+9;return r.Util.extractNumber(this.data,t).result}extractDocumentHistory(){let n=this.extractDocumentEntry(),t={id:-1,pointer:n,generation:0,free:!1,update:!0};if(r.Util.areArraysEqual(this.data.slice(n,n+r.Util.XREF.length),r.Util.XREF)){let t=this.extractCrossReferenceTable(n);this.updates.push(t.getUpdateSection());let i=this.updates[0];while(i.prev)t=this.extractCrossReferenceTable(i.prev),this.updates.push(t.getUpdateSection()),i=this.updates[this.updates.length-1]}else{let n=this.extractCrossReferenceStreamObject(t);this.updates.push(n.getUpdateSection());let i=this.updates[0];while(i.prev){let t={id:-1,pointer:i.prev,generation:0,free:!1,update:!0};n=this.extractCrossReferenceStreamObject(t);this.updates.push(n.getUpdateSection());i=this.updates[this.updates.length-1]}}this.trailerSize=this.getRecentUpdate().size}getRecentUpdate(){return this.updates[0]}createObjectLookupTable(){let n={},t=this.getRecentUpdate(),r=t.size,i=1;while(Object.keys(n).length<r){let r=t.refs;for(let t of r)n.hasOwnProperty(t.id)||(n[t.id]=t);t=this.updates[i];++i}return n}getFreeObjectId(){let t=this.createObjectLookupTable(),n=t[0];if(!n)throw Error("Crosssite reference has no header for the linked list of free objects");if(0===n.pointer){if(-1===this.trailerSize)throw Error("Trailer size not set");return{obj:this.trailerSize++,generation:0,reused:!1}}let i=n.pointer,r=[];while(i!==0){if(r.push(n),n=t[i],!n.free)return{obj:this.trailerSize++,generation:0,reused:!1};i=n.pointer}let f=n=>{for(let n of n.reverse())if(n.generation<65535&&-1===this.already_reused_ids.indexOf(n))return n;return undefined},u=f(r);if(u)n=u,this.already_reused_ids.push(n);else return{obj:this.trailerSize++,generation:0,reused:!1};return{obj:n.pointer,generation:t[n.id].generation,reused:!0}}}t.DocumentHistory=o},"./src/index.ts":function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});r=i("./src/parser.ts");t.PDFDocumentParser=r.PDFDocumentParser;u=i("./src/util.ts");t.Util=u.Util;f=i("./src/annotation.ts");t.AnnotationFactory=f.AnnotationFactory},"./src/object-util.ts":function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./src/util.ts"),f=i("./src/array-util.ts"),e=i("./src/stream.ts");class u{static extractDictKeyRec(n,t,i){let e=r.Util.readNextWord(n,t),f=e.result;if(!f)return t;let o=r.Util.skipDelimiter(f,0);if(f[0]&&r.Util.DICT_END[0]===f[0]){let t=r.Util.readNextWord(n,e.end_index+1);if(t.result&&r.Util.DICT_END[0]===t.result[0])return t.end_index}return u.extractDictValueRec(n,e.end_index+1,i,r.Util.convertAsciiToString(f))}static extractDictValueRec(n,t,i,e=undefined){let o=r.Util.readNextWord(n,t),s=o.result||new Uint8Array([]);if(t=o.end_index-s.length+1,s[0]===r.Util.ARRAY_START[0]){if(!e)throw Error("Invalid anonymous array definition");let r=f.ArrayUtil.extractArray(n,t);return i[e]=r.result,u.extractDictKeyRec(n,r.end_index+1,i)}if(s[0]===r.Util.DICT_START[0]&&n[o.end_index+1]===r.Util.DICT_START[0]){if(e){let t={},r=u.extractDictKeyRec(n,o.end_index+2,t);return i[e]=t,u.extractDictKeyRec(n,r+1,i)}return u.extractDictKeyRec(n,o.end_index+2,i)}if(s[0]===r.Util.HEX_STRING_START[0]){if(!e)throw Error("Invalid anonymous string definition");let f=r.Util.extractHexString(n,t);return i[e]=f.result,u.extractDictKeyRec(n,f.end_index+1,i)}if(s[0]===r.Util.LITERAL_STRING_START[0]){if(!e)throw Error("Invalid anonymous string definition");let f=r.Util.extractString(n,t);return i[e]=f.result,u.extractDictKeyRec(n,f.end_index+1,i)}if(s[0]===47){if(!e)throw Error("Invalid anonymous property definition");let f=r.Util.extractOptionValue(n,t);return i[e]="/"+f.result,u.extractDictKeyRec(n,f.end_index+1,i)}let h=r.Util.readNextWord(n,o.end_index+1),f=h.result||new Uint8Array([]);if(!e)throw Error("Invalid anonymous reference/number definition");let s=o.end_index+1;if(f[0]===47||f[0]===r.Util.DICT_END[0])i[e]=r.Util.extractNumber(n,t).result;else{let u=r.Util.extractReferenceTyped(n,t);i[e]=u.result;s=u.end_index+1}return u.extractDictKeyRec(n,s,i)}static extractObject(n,t,i=undefined){if(typeof t!="number"&&t.compressed){if(!i)throw Error("Provide ObjectLookupTable to extract stream object");return u.extractStreamObject(n,t.id,t.generation,i[t.pointer])}let e={},o=typeof t=="number"?t:t.pointer,h=r.Util.extractObjectId(n,o);e.id=h;o=r.Util.locateSequence(r.Util.OBJ,n,o)+r.Util.OBJ.length;let c=r.Util.locateSequence(r.Util.ENDOBJ,n,o);n=n.slice(o,c);let s=r.Util.readNextWord(n,0);if(s.result&&s.result[0]===r.Util.DICT_START[0]){let t={};u.extractDictValueRec(n,0,t);e.value=t}else if(s.result&&s.result[0]===r.Util.ARRAY_START[0]){let t=f.ArrayUtil.extractArray(n,0);e.value=t.result}else throw Error(`Invalid object type - starting with: ${s.result}`);if(o=r.Util.locateSequence(r.Util.STREAM,n,0),-1!==o){let t=o+r.Util.STREAM.length;t=r.Util.skipDelimiter(n,t);let i=t+e.value["/Length"];e.stream=u.extractStreamData(n.slice(t,i),e.value["/Filter"],u.translateDecodeParams(e))}return e}static extractStreamObject(n,t,i,f){let o=f.pointer,a={},p=r.Util.extractObjectId(n,o);a.id=p;o=r.Util.locateSequence(r.Util.OBJ,n,o)+r.Util.OBJ.length;let w=r.Util.locateSequence(r.Util.ENDOBJ,n,o);n=n.slice(o,w);let v=r.Util.readNextWord(n,0);if(!v.result||v.result[0]!==r.Util.DICT_START[0])throw Error("Invalid stream object -- no dict");let e={};if(u.extractDictValueRec(n,0,e),a.value=e,!e["/Filter"]||e["/Filter"]!=="/FlateDecode")throw Error(`Unsupported stream filter: ${e["/Filter"]} - Only supported filter is FlateDecode`);if(!e["/Type"]||e["/Type"]!=="/ObjStm")throw Error(`Invalid stream object type: ${e["/Type"]}`);let b=e["/Length"],h=r.Util.locateSequence(r.Util.STREAM,n)+r.Util.STREAM.length;h=r.Util.skipDelimiter(n,h);let k=h+b,c=u.extractStreamData(n.slice(h,k),e["/Filter"],u.translateDecodeParams(e));if(!e["/N"])throw Error("Invalid stream object -- no number of objects specified");if(!e["/First"])throw Error("Invalid stream object -- no offset to the first objct specified");let l=u.extractStreamObjectTable(c,e["/N"],e["/First"]);if(!l[t])throw Error(`Object ${t} not in stream object`);let s={id:{obj:t,generation:0}},y={};return s.pointer_stream_end=u.extractDictValueRec(c.getData(),l[t],y),s.value=y,s.stream=c,s.pointer_stream_start=l[t],s}static translateDecodeParams(n){return n.value?n.value["/DecodeParms"]?n.value["/DecodeParms"]["/Columns"]?n.value["/DecodeParms"]["/Predictor"]?{columns:n.value["/DecodeParms"]["/Columns"],predictor:n.value["/DecodeParms"]["/Predictor"]}:undefined:undefined:undefined:undefined}static extractStreamObjectTable(n,t,i){let r={};for(let u=0;u<t;++u){let t=n.getNumber(),u=n.getNumber()+i;r[t]=u}return r}static extractStreamData(n,t,i=undefined){let r=undefined;if(t==="/FlateDecode")r=new e.FlateStream(n,i);else throw Error(`Unsupported stream filter: ${t} - Only supported filter is FlateDecode (right now)`);if(!r)throw Error("Could not derive stream");return r}}t.ObjectUtil=u;u.i=0},"./src/parser.ts":function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const h=i("./src/util.ts"),r=i("./src/object-util.ts"),u=i("./src/document-history.ts");class f{constructor(n=new Uint8Array([])){this.data=n;this.page=-1;this.type="";this.object_id=null;this.id="";this.rect=[];this.author="";this.pageReference=null;this.updateDate="";this.border=null;this.color=null;this.data=n}extract(n,t,i){let u=r.ObjectUtil.extractObject(this.data,n,i);this.object_id=u.id;u=u.value;this.type=u["/Type"];this.rect=u["/Rect"];this.pageReference=t;this.updateDate=u["/M"];this.border=u["/Border"];this.color=u["/C"];this.author=u["/T"];this.author=u["/NM"];this.contents=u["/Contents"];this.quadPoints=u["/Quadpoints"];this.inkList=u["/Inklist"]}}t.Annotation=f;class e{constructor(n,t,i){this.data=n;this.xref=t;this.objectLookupTable=i;this.pagesObjectId={obj:-1,generation:-1};this.data=n;let u=r.ObjectUtil.extractObject(this.data,t,i).value;if(u["/Type"]!=="/Catalog")throw Error(`Invalid catalog object at position ${t.pointer}`);this.pagesObjectId=u["/Pages"]}getPagesObjectId(){return this.pagesObjectId}}t.CatalogObject=e;class o{constructor(n,t){this.data=n;this.objectLookupTable=t;this.pageCount=-1;this.pageReferences=[];this.data=n}extractPageReferences(n){for(let n of n){let i=this.objectLookupTable[n.obj],t=r.ObjectUtil.extractObject(this.data,i,this.objectLookupTable).value;if(t["/Type"]==="/Page")this.pageReferences.push(n);else if(t["/Type"]==="/Pages")this.extractPageReferences(t["/Kids"]);else throw Error(`Invalid object type ${t["/Type"]}`);}}extract(n,t){let i=r.ObjectUtil.extractObject(this.data,n,t).value;if(this.pageCount=i["/Count"],!i["/Kids"])throw Error(`Could not find index of /Kids in /Pages object`);let u=i["/Kids"];this.pageReferences=[];this.extractPageReferences(u)}getPageCount(){return this.pageCount}getPageReferences(){return this.pageReferences}}t.PageTree=o;class s{constructor(n,t){this.data=n;this.documentHistory=t;this.annots=[];this.hasAnnotsField=!1;this.data=n}extractAnnotationArray(){let n=this.documentHistory.createObjectLookupTable();if(!this.annotsPointer)throw Error("Annotations pointer not set");let t=n[this.annotsPointer.obj],i=r.ObjectUtil.extractObject(this.data,t,n);this.annots=i.value}extract(n,t){let u=r.ObjectUtil.extractObject(this.data,n,t);this.object_id=u.id;let i=u.value["/Annots"];i&&(this.hasAnnotsField=!0,Array.isArray(i)?this.annots=i:(this.annotsPointer=i,this.extractAnnotationArray()))}}t.Page=s;class c{constructor(n){this.data=n;this.version=undefined;this.documentHistory=new u.DocumentHistory(new Uint8Array([]));this.catalogObject=undefined;this.pageTree=undefined;this.data=new Uint8Array(n);this.documentHistory=new u.DocumentHistory(this.data);this.documentHistory.extractDocumentHistory()}getPDFVersion(){return this.version?this.version:(this.version=h.Util.extractVersion(this.data,0),this.version)}getFreeObjectId(){return this.documentHistory.getFreeObjectId()}getCatalog(){let n=this.documentHistory.getRecentUpdate();if(n.root){let i=n.root,t=this.documentHistory.createObjectLookupTable();return new e(this.data,t[i.obj],t)}if(this.catalogObject)return this.catalogObject;throw Error("Does not work for compressed data");}getPageTree(){if(this.pageTree)return this.pageTree;let n=this.documentHistory.createObjectLookupTable(),i=this.getCatalog(),r=i.getPagesObjectId(),u=n[r.obj],t=new o(this.data,n);return t.extract(u,n),this.pageTree=t,t}getPage(n){let r=this.getPageTree(),u=r.getPageReferences()[n],t=this.documentHistory.createObjectLookupTable(),f=t[u.obj],i=new s(this.data,this.documentHistory);return i.extract(f,t),i}extractAnnotations(){let n=[],i=this.getPageTree(),t=this.documentHistory.createObjectLookupTable(),r=i.getPageCount();for(let i=0;i<r;++i){let r=this.getPage(i),e=r.annots,u=[];for(let n of e){let e=new f(this.data);e.extract(t[n.obj],r,t);e.page=i;u.push(e)}n.push(u)}return n}}t.PDFDocumentParser=c},"./src/stream.ts":function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const u=i("./src/util.ts"),f=i("./node_modules/pako/index.js");class r{constructor(n){this.data=n;this._ptr=0}getData(){return this.data}getLength(){return this.data.length}peekNBytes(n=1,t=0){return this.data.slice(t,t+n)}peekNBytesAsNumber(n=1,t=0){let i=0;for(let r=0;r<n;++r)i+=this.data[r+t]<<8*(n-r-1);return i}getNBytesAsNumber(n=1){let t=this.peekNBytesAsNumber(n,this._ptr);return this._ptr+=n,t}getByte(){return this.data[this._ptr++]}getNumber(){let n=u.Util.extractNumber(this.data,this._ptr);return this._ptr=n.end_index+1,n.result}}t.Stream=r;class e extends r{constructor(n,t=undefined){super(n);this.data=n;this.decodeParameters=t;this.data.length>0&&(this.data=f.inflate(n));t&&(this.data=this.applyFilter(this.data,t))}applyFilter(n,t){if(t.predictor>=10)return this.applyPNGFilter(n,t);if(t.predictor===2)throw Error("Unsupported filter -- file feature request");return n}applyPNGFilter(n,t){if(n.length%(t.columns+1)!=0)throw Error("Invalid decode parameters");let i=t.columns+1,r=[],u=0;for(let f=0;f<n.length;++f){let o=0,s=0,e=0,h=0;if(f%i==0)u=n[f];else switch(u){case 0:r.push(n[f]);break;case 1:o=f%i-2<0?0:r[(f-2)%t.columns+Math.floor(f/i)*(t.columns-1)];r.push((n[f]+o)%256);break;case 2:e=f-(i+Math.floor(f/i));s=e<0?0:r[e];r.push((n[f]+s)%256);break;case 3:e=f-(i+Math.floor(f/i));e=f-(i+Math.floor(f/i));s=e<0?0:r[e];o=f%i-2<0?0:r[(f-2)%t.columns+Math.floor(f/i)*(t.columns-1)];r.push((n[f]+Math.floor((s+o)/2))%256);break;case 4:e=f-(i+Math.floor(f/i));s=e<0?0:r[e];o=f%i-2<0?0:r[(f-2)%t.columns+Math.floor(f/i)*(t.columns-1)];h=e-1<0?0:r[e-1];r.push((n[f]+this.paethPredictor(o,s,h))%256)}}return new Uint8Array(r)}paethPredictor(n,t,i){let r=n+t-i,u=Math.abs(r-n),f=Math.abs(r-t),e=Math.abs(r-i);return u<=f&&u<=e?n:f<=e?t:i}}t.FlateStream=e},"./src/util.ts":function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static extractVersion(n,t=0){let u=i.locateSequence(i.VERSION,n,t)+i.VERSION.length,r=i.locateSequence([i.DOT],n,u),f=i.extractNumber(n,u,r).result,e=i.locateDelimiter(n,r),o=i.extractNumber(n,r+1,e).result;return{major:f,minor:o}}static readNextWord(n,t=0){if(t>=n.length)return{result:undefined,end_index:n.length-1};if(t=i.skipSpaces(n,t),n[t]===37){while(n[t]!==13&&n[t]!=10&&t<n.length)++t;t=i.skipSpaces(n,t)}let r=t;for(t++;!i.isDelimiter(n[t])&&t<n.length;)++t;return t<=n.length?{result:n.slice(r,t),end_index:t-1}:{result:undefined,end_index:t-1}}static skipDelimiter(n,t=0){while(t<n.length&&this.isDelimiter(n[t]))++t;return t}static skipSpaces(n,t=0){while(t<n.length&&(n[t]===10||n[t]===13||n[t]===32))++t;return t}static skipDelimiterReverse(n,t=0){while(t>0&&this.isDelimiter(n[t]))--t;return t}static convertStringToAscii(n){let t=[];for(let i=0;i<n.length;++i)t.push(+n.charCodeAt(i));return t}static isSpace(n){return n===i.LF||n===i.CR||n===i.SPACE}static isDelimiter(n){return i.isSpace(n)||n===47||n===37||n===60||n===62||n===91||n===93||n===40||n===41}static locateSequence(n,t,i=0,r=false){let u=i;for(let i=0;u<t.length;++u)if(t[u]==n[i]){if(i==n.length-1){if(!r||t.length==u+1||this.isDelimiter(t[u+1]))return u-(n.length-1);i=-1}++i}else i=0;return-1}static locateSequenceReversed(n,t,i=t.length-1,r=false){let u=i;for(let i=n.length-1;u>=0;--u)if(t[u]==n[i]){if(i==0){if(!r||u-1<0||this.isDelimiter(t[u-1]))return u;i=n.length}--i}else i=n.length-1;return-1}static locateDelimiter(n,t=0){while(t<n.length&&!this.isDelimiter(n[t]))++t;return t-1}static locateDelimiterReversed(n,t=n.length-1){while(t>0&&!this.isDelimiter(n[t]))--t;return t<=0?t:t-1}static extractObjectId(n,t){t=i.skipDelimiter(n,t);let r=i.locateDelimiter(n,t+1),f=i.extractNumber(n,t,r).result,u=i.skipDelimiter(n,r+1),e=i.locateDelimiter(n,u+1),o=i.extractNumber(n,u,e).result;return{obj:f,generation:o}}static extractReference(n,t){t=i.skipDelimiter(n,t);let r=this.locateSequence(this.convertStringToAscii(" R"),n,t,!0);return n.slice(t,r)}static extractReferenceTyped(n,t){let i=this.extractReference(n,t),r=this.locateDelimiter(i,0),u=this.extractNumber(i,0,r).result,f=this.extractNumber(i,r+2).result;return{result:{obj:u,generation:f},end_index:t+i.length+1}}static extractHexString(n,t){let u=i.locateSequence(i.HEX_STRING_START,n,t),r=i.locateSequence(i.HEX_STRING_END,n,t);return n=n.slice(u+1,r),{result:i.convertUnicodeToString(n),end_index:r}}static extractString(n,t){let u=i.locateSequence(i.LITERAL_STRING_START,n,t),r=i.locateSequence(i.LITERAL_STRING_END,n,t);return n=n.slice(u+1,r),{result:i.convertUnicodeToString(n),end_index:r}}static extractOptionValue(n,t=0){if(n[t]!==47)throw Error("misplaced option value pointer");let r=i.locateDelimiter(n,t+1);return{result:i.convertAsciiToString(Array.from(n.slice(t+1,r+1))),end_index:r}}static extractNumber(n,t,r=-1){if(t=i.skipDelimiter(n,t),-1==r&&(r=i.locateDelimiter(n,t)),r<t)throw Error(`Could not identify number bounds: [${t},${r}]`);let u="";for(let i=t;i<=r;++i)u+=String.fromCharCode(n[i]);if(""===u)throw Error(`Could not parse number at position ${t}`);return{result:+u,end_index:r}}static convertDateToPDFDate(n){let t="(D:";t+=n.getFullYear();let i=String(n.getMonth()+1);t+=(i.length==1?"0":"")+i;let r=String(n.getDate());t+=(r.length==1?"0":"")+r;let u=String(n.getHours());t+=(u.length==1?"0":"")+u;let f=String(n.getMinutes());t+=(f.length==1?"0":"")+f;let e=String(n.getSeconds());return t+=(e.length==1?"0":"")+e,t+")"}static convertUnicodeToString(n){if(n instanceof Uint8Array&&(n=new Uint8Array(n)),n[0]===254&&n[1]===255){n=n.slice(2,n.length);let t=n=>{let t="";for(let i=0;i<n.length-1;i+=2)t+=String.fromCharCode(n[i]<<8|n[i+1]&255);return t};return t(n)}let t=n=>{let i="",t=0;while(t<n.length){let r=n[t++],u;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i+=String.fromCharCode(r);break;case 12:case 13:u=n[t++];i+=String.fromCharCode((r&31)<<6|u&63);break;case 14:u=n[t++];let f=n[t++];i+=String.fromCharCode((r&15)<<12|(u&63)<<6|(f&63)<<0)}}return i};return t(Array.from(n))}static convertAsciiToString(n){let t="";for(let i=0;i<n.length;++i)t+=String.fromCharCode(n[i]);return t}static convertNumberToCharArray(n){return i.convertStringToAscii(String(n))}static areArraysEqual(n,t){if(n.length!==t.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==t[i])return!1;return!0}static debug_printIndexed(n){let t="";for(let r=0;r<n.length;++r)r%10==0&&(t+="\n"+r+":"),t+=i.isSpace(n[r])?" .":" "+String.fromCharCode(n[r]);console.log(t)}}t.Util=i;i.VERSION=[37,80,68,70,45];i.NULL=[110,117,108,108];i.DOT=46;i.CR=13;i.LF=10;i.TYPE="/Type ";i.SPACE=32;i.OBJ=[111,98,106];i.ENDOBJ=[101,110,100,111,98,106];i.ARRAY_START=[91];i.ARRAY_END=[93];i.LITERAL_STRING_START=[40];i.HEX_STRING_START=[60];i.LITERAL_STRING_END=[41];i.HEX_STRING_END=[62];i.R=[82];i.ANNOTS=[47,65,110,110,111,116,115];i.DICT_START=[60,60];i.DICT_END=[62,62];i.PAGE=[47,80,97,103,101];i.SIZE=[47,83,105,122,101];i.ROOT=[47,82,111,111,116];i.PREV=[47,80,114,101,118];i.STARTXREF=[115,116,97,114,116,120,114,101,102];i.XREF=[120,114,101,102];i.STREAM=[115,116,114,101,97,109]},"./src/writer-util.ts":function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./src/util.ts");class u{static writeReferencePointer(n,t=false){let i=r.Util.convertNumberToCharArray(n.obj);return i.push(r.Util.SPACE),i=i.concat(r.Util.convertNumberToCharArray(n.generation)),t&&(i.push(r.Util.SPACE),i.push(...r.Util.R)),i}static pad(n,t){t=String(t);let i=[];for(let r=0;r<n-t.length;++r)i.push(48);return i=i.concat(r.Util.convertNumberToCharArray(t))}static writeNestedNumberArray(n){let t=r.Util.ARRAY_START;for(let n of n)t=t.concat(u.writeNumberArray(n)),t.push(r.Util.SPACE);return t.push(...r.Util.ARRAY_END),t}static writeNumberArray(n){let t=r.Util.ARRAY_START;for(let n of n)t=t.concat(r.Util.convertNumberToCharArray(n)),t.push(r.Util.SPACE);return t.push(...r.Util.ARRAY_END),t}static replaceAnnotsFieldInPageObject(n,t,i,f){let s=r.Util.locateSequence(r.Util.ENDOBJ,n,i,!0),o=n.slice(i,s+r.Util.ENDOBJ.length),e=[];if(t.hasAnnotsField){let n=r.Util.locateSequence(r.Util.ANNOTS,o,0,!0);e=Array.from(o.slice(0,n+r.Util.ANNOTS.length));e.push(r.Util.SPACE);e=e.concat(u.writeReferencePointer(f,!0));e.push(r.Util.SPACE);let t=r.Util.locateSequence(r.Util.ARRAY_END,o,n,!0)+r.Util.ARRAY_END.length;e=e.concat(Array.from(o.slice(t,o.length)))}else{let n=r.Util.locateSequenceReversed(r.Util.DICT_END,o,o.length-1);if(-1===n)throw Error("Could not identify dictionary end");e=Array.from(o.slice(0,n));e=e.concat(r.Util.ANNOTS);e.push(r.Util.SPACE);e=e.concat(u.writeReferencePointer(f,!0));e.push(r.Util.SPACE);e=e.concat(Array.from(o.slice(n,o.length)))}return e.push(r.Util.CR),e.push(r.Util.LF),e}}t.WriterUtil=u},"./src/writer.ts":function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const f=i("./src/util.ts"),e=i("./src/object-util.ts"),u=i("./src/writer-util.ts");class r{constructor(n,t,i,r){this.data=n;this.annotations=t;this.toDelete=i;this.parser=r;this.xrefs=[];this.data=new Uint8Array(n)}sortPageWise(n){let t={};for(let n of n)t[n.page]||(t[n.page]=[]),t[n.page].push(n);return t}adaptPageObject(n,t){if(!n.object_id)throw Error("Page without object id");let f=this.parser.documentHistory.createObjectLookupTable(),i=f[n.object_id.obj];if(i.compressed){let h=e.ObjectUtil.extractObject(this.data,i,f),c=h.stream.getData().slice(h.pointer_stream_start,h.pointer_stream_end+1),o=u.WriterUtil.writeReferencePointer(h.id,!1).concat(32),s=new Uint8Array(o.length+r.OBJ.length+c.length+r.ENDOBJ.length);return s.set(o),s.set(r.OBJ,o.length),s.set(c,r.OBJ.length+o.length),s.set(r.ENDOBJ,r.OBJ.length+c.length+o.length),u.WriterUtil.replaceAnnotsFieldInPageObject(s,n,0,t)}return u.WriterUtil.replaceAnnotsFieldInPageObject(this.data,n,i.pointer,t)}writeAnnotArray(n,t){let f=n[0].pageReference;if(!f)throw Error("Missing page reference");if(!f.object_id)throw Error("Page without object id");let e=f.annots;e=e.concat(n.map(n=>{if(!n.object_id)throw Error("Annotation with object_id null");return n.object_id}));e=e.filter(n=>{let i=t.find(t=>t.object_id.obj===n.obj&&t.object_id.generation===n.generation);return i?(i.is_deleted=!0,!1):!0});let o=f.annotsPointer,s=[];o||(o=this.parser.getFreeObjectId(),s=this.adaptPageObject(f,o));let i=u.WriterUtil.writeReferencePointer(o);i.push(r.SPACE);i=i.concat(r.OBJ);i.push(r.SPACE);i.push(r.ARRAY_START);for(let n of e)i=i.concat(u.WriterUtil.writeReferencePointer(n,!0)),i.push(r.SPACE);return i.push(r.ARRAY_END),i.push(r.SPACE),i=i.concat(r.ENDOBJ),i.push(r.CR),i.push(r.LF),{ptr:o,data:i,pageReference:f.object_id,pageData:s}}convertSubtype(n){switch(n){case"Text":case"/Text":return[47,84,101,120,116];case"Highlight":case"/Highlight":return[47,72,105,103,104,108,105,103,104,116];case"Underline":case"/Underline":return[47,85,110,100,101,114,108,105,110,101];case"Squiggly":case"/Squiggly":return[47,83,113,117,105,103,103,108,121];case"StrikeOut":case"/StrikeOut":return[47,83,116,114,105,107,101,79,117,116];case"Square":case"/Square":return[47,83,113,117,97,114,101];case"Circle":case"/Circle":return[47,67,105,114,99,108,101];case"FreeText":case"/FreeText":return[47,70,114,101,101,84,101,120,116];case"Polygon":case"/Polygon":return[47,80,111,108,121,103,111,110];case"PolyLine":case"/PolyLine":return[47,80,111,108,121,76,105,110,101];case"Stamp":case"/Stamp":return[47,83,116,97,109,112];case"Caret":case"/Caret":return[47,67,97,114,101,116];case"Ink":case"/Ink":return[47,73,110,107]}return[]}writeAnnotationObject(n){if(n.author||(n.author=""),n.contents||(n.contents=""),!n.object_id)throw Error("No object_id");let t=u.WriterUtil.writeReferencePointer(n.object_id);t.push(r.SPACE);t=t.concat(r.OBJ);t.push(r.SPACE);t=t.concat(r.DICT_START);t=t.concat(r.TYPE_ANNOT);t.push(r.SPACE);n.rect&&n.rect.length>0&&(t=t.concat(r.RECT),t.push(r.SPACE),t=t.concat(u.WriterUtil.writeNumberArray(n.rect)),t.push(r.SPACE));t=t.concat(r.SUBTYPE);t.push(r.SPACE);t=t.concat(this.convertSubtype(n.type));t.push(r.SPACE);t=t.concat(r.UPDATE_DATE);t.push(r.SPACE);t=t.concat(f.Util.convertStringToAscii(n.updateDate));t.push(r.SPACE);t=t.concat(r.AUTHOR);t.push(r.SPACE);t.push(r.BRACKET_START);t=t.concat(f.Util.convertStringToAscii(n.author));t.push(r.BRACKET_END);t.push(r.SPACE);n.contents&&(t=t.concat(r.CONTENTS),t.push(r.SPACE),t.push(r.BRACKET_START),t=t.concat(f.Util.convertStringToAscii(n.contents)),t.push(r.BRACKET_END),t.push(r.SPACE));t=t.concat(r.ID);t.push(r.SPACE);t=t.concat(f.Util.convertStringToAscii(n.id));t.push(r.SPACE);n.annotation_flag&&(t=t.concat(r.FLAG),t.push(r.SPACE),t=t.concat(f.Util.convertNumberToCharArray(n.annotation_flag)),t.push(r.SPACE));n.color&&(n.color.r>1&&(n.color.r/=255),n.color.g>1&&(n.color.g/=255),n.color.b>1&&(n.color.b/=255),t.push(r.SPACE),t=t.concat(r.COLOR),t.push(r.SPACE),t=t.concat(u.WriterUtil.writeNumberArray([n.color.r,n.color.g,n.color.b])),t.push(r.SPACE));let i=n.opacity;if(i&&(t=t.concat(r.OPACITY),t.push(r.SPACE),t=t.concat(f.Util.convertNumberToCharArray(i)),t.push(r.SPACE)),n.border&&(t.push(r.SPACE),t=t.concat(r.BORDER),t.push(r.SPACE),t=t.concat(u.WriterUtil.writeNumberArray([n.border.horizontal_corner_radius,n.border.vertical_corner_radius,n.border.border_width])),t.push(r.SPACE)),n.defaultAppearance&&(t.push(r.SPACE),t=t.concat(r.DEFAULT_APPEARANCE),t.push(r.SPACE),t.push(r.BRACKET_START),t=t.concat(f.Util.convertStringToAscii(n.defaultAppearance)),t.push(r.BRACKET_END),t.push(r.SPACE)),!n.pageReference)throw Error("No page reference");return n.pageReference.object_id&&(t.push(r.SPACE),t=t.concat(r.PAGE_REFERENCE),t.push(r.SPACE),t=t.concat(u.WriterUtil.writeReferencePointer(n.pageReference.object_id,!0)),t.push(r.SPACE)),n.quadPoints&&(t=t.concat(r.QUADPOINTS),t.push(r.SPACE),t=t.concat(u.WriterUtil.writeNumberArray(n.quadPoints)),t.push(r.SPACE)),n.vertices&&(t=t.concat(r.VERTICES),t.push(r.SPACE),t=t.concat(u.WriterUtil.writeNumberArray(n.vertices)),t.push(r.SPACE)),n.stampType&&(t=t.concat(r.NAME),t.push(r.SPACE),t=t.concat(r.DRAFT),t.push(r.SPACE)),n.caretSymbol&&(t=t.concat(r.SY),t.push(r.SPACE),t.push(r.P),t.push(r.SPACE)),n.inkList&&(t=t.concat(r.INKLIST),t.push(r.SPACE),t=t.concat(u.WriterUtil.writeNestedNumberArray(n.inkList)),t.push(r.SPACE)),t=t.concat(r.DICT_END),t.push(r.SPACE),t=t.concat(r.ENDOBJ),t.push(r.CR),t.push(r.LF),{ptr:n.object_id,data:t}}computeXrefSequences(){let i=[],n=this.xrefs.sort((n,t)=>n.id<t.id?-1:n.id>t.id?1:0),t=[n[0]],r=n[0].id;i.push(t);for(let u=1;u<n.length;++u)n[u].id===r+1?t.push(n[u]):(t=[n[u]],i.push(t)),r=n[u].id;return i}applyObjectFreeing(n){let r=this.parser.documentHistory.createObjectLookupTable()[0],u=r.id,t=n.filter(n=>n.free);t=t.sort((n,t)=>n.id<t.id?-1:n.id>t.id?1:0);let i=undefined;for(let n of t)i||(r.pointer=n.id),i&&(i.pointer=n.id),i=n;return t.length>0&&(t[t.length-1].pointer=u),n.push(r),n}writeCrossSiteReferenceTable(){let n=r.XREF;n.push(r.CR);n.push(r.LF);this.xrefs=this.applyObjectFreeing(this.xrefs);let t=this.computeXrefSequences();for(let t of t){let i=t[0];n=n.concat(f.Util.convertNumberToCharArray(i.id));n.push(r.SPACE);n=n.concat(f.Util.convertNumberToCharArray(t.length));n.push(r.CR);n.push(r.LF);for(let i=0;i<t.length;++i){let f=[];if(f=f.concat(u.WriterUtil.pad(10,t[i].pointer)),f.push(r.SPACE),f=f.concat(u.WriterUtil.pad(5,t[i].generation)),f.push(r.SPACE),t[i].free&&f.push(r.F),t[i].update&&f.push(r.N),f.push(r.CR),f.push(r.LF),f.length<20)throw Error("XRef entry < 20 bytes");n=n.concat(f)}}return n}writeTrailer(n){let t=r.TRAILER;t.push(r.CR);t.push(r.LF);t=t.concat(r.DICT_START);t=t.concat(r.SIZE);t.push(r.SPACE);t=t.concat(f.Util.convertNumberToCharArray(this.parser.documentHistory.trailerSize));t.push(r.SPACE);let i=this.parser.documentHistory.getRecentUpdate();if(t=t.concat(r.ROOT),t.push(r.SPACE),!i.root)throw Error("No root object in trailer, although this is an cross reference table document");return t=t.concat(u.WriterUtil.writeReferencePointer(i.root,!0)),t.push(r.SPACE),t=t.concat(r.PREV),t.push(r.SPACE),t=t.concat(f.Util.convertNumberToCharArray(this.parser.documentHistory.getRecentUpdate().start_pointer)),t.push(r.SPACE),t=t.concat(r.DICT_END),t.push(r.CR),t.push(r.LF),t=t.concat(r.STARTXREF),t.push(r.CR),t.push(r.LF),t=t.concat(f.Util.convertNumberToCharArray(n)),t.push(r.CR),t.push(r.LF),t=t.concat(r.EOF),t.push(r.CR),t.push(r.LF),t}write(){let u=this.sortPageWise(this.annotations),t=this.data.length,n=[];this.data[t-1]===70&&(n.push(r.CR),n.push(r.LF),t+=2);for(let i in u){let f=u[i],r=this.writeAnnotArray(f,this.toDelete);this.xrefs.push({id:r.ptr.obj,pointer:t,generation:r.ptr.generation,free:!1,update:!0});n=n.concat(r.data);t+=r.data.length;r.pageData.length>0&&(this.xrefs.push({id:r.pageReference.obj,pointer:t,generation:r.pageReference.generation,free:!1,update:!0}),n=n.concat(r.pageData),t+=r.pageData.length);for(let i of f){let r=this.writeAnnotationObject(i);this.xrefs.push({id:r.ptr.obj,pointer:t,generation:r.ptr.generation,free:!1,update:!0});n=n.concat(r.data);t+=r.data.length}}let e=this.toDelete.filter(n=>!n.is_deleted),f=this.sortPageWise(e);for(let i in f){let r=this.updatePageAnnotationReferenceArray(f[i]);this.xrefs.push({id:r.ptr.obj,pointer:t,generation:r.ptr.generation,free:!1,update:!0});n=n.concat(r.data);t+=r.data.length}for(let n of this.toDelete)n.object_id&&this.xrefs.push({id:n.object_id.obj,pointer:-1,generation:n.object_id.generation+1,free:!0,update:!1});let o=this.writeCrossSiteReferenceTable();n=n.concat(o);let s=this.writeTrailer(t);n=n.concat(s);let h=new Uint8Array(n),i=new Uint8Array(this.data.length+h.length);return i.set(this.data),i.set(n,this.data.length),i}updatePageAnnotationReferenceArray(n){let i=n[0].pageReference;if(!i)throw Error("Missing page reference");if(!i.object_id)throw Error("Page without object id");let f=i.annots;f=f.filter(t=>{let i=n.find(n=>n.object_id.obj===t.obj&&n.object_id.generation===t.generation);return i?(i.is_deleted=!0,!1):!0});let e=i.annotsPointer,t=u.WriterUtil.writeReferencePointer(e);t.push(r.SPACE);t=t.concat(r.OBJ);t.push(r.SPACE);t.push(r.ARRAY_START);for(let n of f)t=t.concat(u.WriterUtil.writeReferencePointer(n,!0)),t.push(r.SPACE);return t.push(r.ARRAY_END),t.push(r.SPACE),t=t.concat(r.ENDOBJ),t.push(r.CR),t.push(r.LF),{ptr:e,data:t}}}t.Writer=r;r.N=110;r.F=102;r.SPACE=32;r.CR=13;r.LF=10;r.OBJ=[111,98,106];r.ENDOBJ=[101,110,100,111,98,106];r.ARRAY_START=91;r.ARRAY_END=93;r.DICT_START=[60,60];r.DICT_END=[62,62];r.TYPE_ANNOT=[47,84,121,112,101,r.SPACE,47,65,110,110,111,116];r.RECT=[47,82,101,99,116];r.SUBTYPE=[47,83,117,98,116,121,112,101];r.UPDATE_DATE=[47,77];r.AUTHOR=[47,84];r.CONTENTS=[47,67,111,110,116,101,110,116,115];r.BRACKET_START=40;r.BRACKET_END=41;r.FLAG=[47,70];r.ID=[47,78,77];r.COLOR=[47,67];r.OPACITY=[47,67,65];r.BORDER=[47,66,111,114,100,101,114];r.PAGE_REFERENCE=[47,80];r.DEFAULT_APPEARANCE=[47,68,65];r.INKLIST=[47,73,110,107,76,105,115,116];r.TRAILER=[116,114,97,105,108,101,114];r.SIZE=[47,83,105,122,101];r.ROOT=[47,82,111,111,116];r.PREV=[47,80,114,101,118];r.STARTXREF=[115,116,97,114,116,120,114,101,102];r.EOF=[37,37,69,79,70];r.XREF=[120,114,101,102];r.QUADPOINTS=[47,81,117,97,100,80,111,105,110,116,115];r.VERTICES=[47,86,101,114,116,105,99,101,115];r.NAME=[47,78,97,109,101];r.DRAFT=[47,68,114,97,102,116];r.SY=[47,83,121];r.P=80}})})